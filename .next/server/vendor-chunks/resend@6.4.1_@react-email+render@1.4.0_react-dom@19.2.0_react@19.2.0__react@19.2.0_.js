"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/resend@6.4.1_@react-email+render@1.4.0_react-dom@19.2.0_react@19.2.0__react@19.2.0_";
exports.ids = ["vendor-chunks/resend@6.4.1_@react-email+render@1.4.0_react-dom@19.2.0_react@19.2.0__react@19.2.0_"];
exports.modules = {

/***/ "(action-browser)/./node_modules/.pnpm/resend@6.4.1_@react-email+render@1.4.0_react-dom@19.2.0_react@19.2.0__react@19.2.0_/node_modules/resend/dist/index.mjs":
/*!***************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/resend@6.4.1_@react-email+render@1.4.0_react-dom@19.2.0_react@19.2.0__react@19.2.0_/node_modules/resend/dist/index.mjs ***!
  \***************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Resend: () => (/* binding */ Resend)\n/* harmony export */ });\n/* harmony import */ var svix__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! svix */ \"(action-browser)/./node_modules/.pnpm/svix@1.76.1/node_modules/svix/dist/index.js\");\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\n\n// package.json\nvar version = \"6.4.1\";\n\n// src/common/utils/build-pagination-query.ts\nfunction buildPaginationQuery(options) {\n  const searchParams = new URLSearchParams();\n  if (options.limit !== void 0) {\n    searchParams.set(\"limit\", options.limit.toString());\n  }\n  if (\"after\" in options && options.after !== void 0) {\n    searchParams.set(\"after\", options.after);\n  }\n  if (\"before\" in options && options.before !== void 0) {\n    searchParams.set(\"before\", options.before);\n  }\n  return searchParams.toString();\n}\n\n// src/api-keys/api-keys.ts\nvar ApiKeys = class {\n  constructor(resend) {\n    this.resend = resend;\n  }\n  async create(payload, options = {}) {\n    const data = await this.resend.post(\n      \"/api-keys\",\n      payload,\n      options\n    );\n    return data;\n  }\n  async list(options = {}) {\n    const queryString = buildPaginationQuery(options);\n    const url = queryString ? `/api-keys?${queryString}` : \"/api-keys\";\n    const data = await this.resend.get(url);\n    return data;\n  }\n  async remove(id) {\n    const data = await this.resend.delete(\n      `/api-keys/${id}`\n    );\n    return data;\n  }\n};\n\n// src/common/utils/parse-email-to-api-options.ts\nfunction parseAttachments(attachments) {\n  return attachments == null ? void 0 : attachments.map((attachment) => ({\n    content: attachment.content,\n    filename: attachment.filename,\n    path: attachment.path,\n    content_type: attachment.contentType,\n    content_id: attachment.contentId\n  }));\n}\nfunction parseEmailToApiOptions(email) {\n  return {\n    attachments: parseAttachments(email.attachments),\n    bcc: email.bcc,\n    cc: email.cc,\n    from: email.from,\n    headers: email.headers,\n    html: email.html,\n    reply_to: email.replyTo,\n    scheduled_at: email.scheduledAt,\n    subject: email.subject,\n    tags: email.tags,\n    text: email.text,\n    to: email.to,\n    template: email.template ? {\n      id: email.template.id,\n      variables: email.template.variables\n    } : void 0,\n    topic_id: email.topicId\n  };\n}\n\n// src/render.ts\nasync function render(node) {\n  let render2;\n  try {\n    ({ render: render2 } = await Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/next@15.2.4_react-dom@19.2.0_react@19.2.0__react@19.2.0\"), __webpack_require__.e(\"vendor-chunks/entities@4.5.0\"), __webpack_require__.e(\"vendor-chunks/domutils@3.2.2\"), __webpack_require__.e(\"vendor-chunks/htmlparser2@8.0.2\"), __webpack_require__.e(\"vendor-chunks/prettier@3.6.2\"), __webpack_require__.e(\"vendor-chunks/peberminta@0.9.0\"), __webpack_require__.e(\"vendor-chunks/domhandler@5.0.3\"), __webpack_require__.e(\"vendor-chunks/dom-serializer@2.0.0\"), __webpack_require__.e(\"vendor-chunks/selderee@0.11.0\"), __webpack_require__.e(\"vendor-chunks/parseley@0.12.1\"), __webpack_require__.e(\"vendor-chunks/leac@0.6.0\"), __webpack_require__.e(\"vendor-chunks/html-to-text@9.0.5\"), __webpack_require__.e(\"vendor-chunks/domelementtype@2.3.0\"), __webpack_require__.e(\"vendor-chunks/@selderee+plugin-htmlparser2@0.11.0\"), __webpack_require__.e(\"vendor-chunks/@react-email+render@1.4.0_react-dom@19.2.0_react@19.2.0__react@19.2.0\"), __webpack_require__.e(\"vendor-chunks/deepmerge@4.3.1\")]).then(__webpack_require__.bind(__webpack_require__, /*! @react-email/render */ \"(action-browser)/./node_modules/.pnpm/@react-email+render@1.4.0_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/@react-email/render/dist/node/index.mjs\")));\n  } catch (e) {\n    throw new Error(\n      \"Failed to render React component. Make sure to install `@react-email/render` or `@react-email/components`.\"\n    );\n  }\n  return render2(node);\n}\n\n// src/batch/batch.ts\nvar Batch = class {\n  constructor(resend) {\n    this.resend = resend;\n  }\n  async send(payload, options) {\n    return this.create(payload, options);\n  }\n  async create(payload, options) {\n    var _a;\n    const emails = [];\n    for (const email of payload) {\n      if (email.react) {\n        email.html = await render(email.react);\n        email.react = void 0;\n      }\n      emails.push(parseEmailToApiOptions(email));\n    }\n    const data = await this.resend.post(\n      \"/emails/batch\",\n      emails,\n      __spreadProps(__spreadValues({}, options), {\n        headers: __spreadValues({\n          \"x-batch-validation\": (_a = options == null ? void 0 : options.batchValidation) != null ? _a : \"strict\"\n        }, options == null ? void 0 : options.headers)\n      })\n    );\n    return data;\n  }\n};\n\n// src/broadcasts/broadcasts.ts\nvar Broadcasts = class {\n  constructor(resend) {\n    this.resend = resend;\n  }\n  async create(payload, options = {}) {\n    if (payload.react) {\n      payload.html = await render(payload.react);\n    }\n    const data = await this.resend.post(\n      \"/broadcasts\",\n      {\n        name: payload.name,\n        segment_id: payload.segmentId,\n        audience_id: payload.audienceId,\n        preview_text: payload.previewText,\n        from: payload.from,\n        html: payload.html,\n        reply_to: payload.replyTo,\n        subject: payload.subject,\n        text: payload.text,\n        topic_id: payload.topicId\n      },\n      options\n    );\n    return data;\n  }\n  async send(id, payload) {\n    const data = await this.resend.post(\n      `/broadcasts/${id}/send`,\n      { scheduled_at: payload == null ? void 0 : payload.scheduledAt }\n    );\n    return data;\n  }\n  async list(options = {}) {\n    const queryString = buildPaginationQuery(options);\n    const url = queryString ? `/broadcasts?${queryString}` : \"/broadcasts\";\n    const data = await this.resend.get(url);\n    return data;\n  }\n  async get(id) {\n    const data = await this.resend.get(\n      `/broadcasts/${id}`\n    );\n    return data;\n  }\n  async remove(id) {\n    const data = await this.resend.delete(\n      `/broadcasts/${id}`\n    );\n    return data;\n  }\n  async update(id, payload) {\n    if (payload.react) {\n      payload.html = await render(payload.react);\n    }\n    const data = await this.resend.patch(\n      `/broadcasts/${id}`,\n      {\n        name: payload.name,\n        segment_id: payload.segmentId,\n        audience_id: payload.audienceId,\n        from: payload.from,\n        html: payload.html,\n        text: payload.text,\n        subject: payload.subject,\n        reply_to: payload.replyTo,\n        preview_text: payload.previewText,\n        topic_id: payload.topicId\n      }\n    );\n    return data;\n  }\n};\n\n// src/common/utils/parse-contact-properties-to-api-options.ts\nfunction parseContactPropertyFromApi(contactProperty) {\n  return {\n    id: contactProperty.id,\n    key: contactProperty.key,\n    createdAt: contactProperty.created_at,\n    type: contactProperty.type,\n    fallbackValue: contactProperty.fallback_value\n  };\n}\nfunction parseContactPropertyToApiOptions(contactProperty) {\n  if (\"key\" in contactProperty) {\n    return {\n      key: contactProperty.key,\n      type: contactProperty.type,\n      fallback_value: contactProperty.fallbackValue\n    };\n  }\n  return {\n    fallback_value: contactProperty.fallbackValue\n  };\n}\n\n// src/contact-properties/contact-properties.ts\nvar ContactProperties = class {\n  constructor(resend) {\n    this.resend = resend;\n  }\n  async create(options) {\n    const apiOptions = parseContactPropertyToApiOptions(options);\n    const data = await this.resend.post(\n      \"/contact-properties\",\n      apiOptions\n    );\n    return data;\n  }\n  async list(options = {}) {\n    const queryString = buildPaginationQuery(options);\n    const url = queryString ? `/contact-properties?${queryString}` : \"/contact-properties\";\n    const response = await this.resend.get(url);\n    if (response.data) {\n      return {\n        data: __spreadProps(__spreadValues({}, response.data), {\n          data: response.data.data.map(\n            (apiContactProperty) => parseContactPropertyFromApi(apiContactProperty)\n          )\n        }),\n        headers: response.headers,\n        error: null\n      };\n    }\n    return response;\n  }\n  async get(id) {\n    if (!id) {\n      return {\n        data: null,\n        headers: null,\n        error: {\n          message: \"Missing `id` field.\",\n          statusCode: null,\n          name: \"missing_required_field\"\n        }\n      };\n    }\n    const response = await this.resend.get(\n      `/contact-properties/${id}`\n    );\n    if (response.data) {\n      return {\n        data: __spreadValues({\n          object: \"contact_property\"\n        }, parseContactPropertyFromApi(response.data)),\n        headers: response.headers,\n        error: null\n      };\n    }\n    return response;\n  }\n  async update(payload) {\n    if (!payload.id) {\n      return {\n        data: null,\n        headers: null,\n        error: {\n          message: \"Missing `id` field.\",\n          statusCode: null,\n          name: \"missing_required_field\"\n        }\n      };\n    }\n    const apiOptions = parseContactPropertyToApiOptions(payload);\n    const data = await this.resend.patch(\n      `/contact-properties/${payload.id}`,\n      apiOptions\n    );\n    return data;\n  }\n  async remove(id) {\n    if (!id) {\n      return {\n        data: null,\n        headers: null,\n        error: {\n          message: \"Missing `id` field.\",\n          statusCode: null,\n          name: \"missing_required_field\"\n        }\n      };\n    }\n    const data = await this.resend.delete(\n      `/contact-properties/${id}`\n    );\n    return data;\n  }\n};\n\n// src/contacts/segments/contact-segments.ts\nvar ContactSegments = class {\n  constructor(resend) {\n    this.resend = resend;\n  }\n  async list(options) {\n    if (!options.contactId && !options.email) {\n      return {\n        data: null,\n        headers: null,\n        error: {\n          message: \"Missing `id` or `email` field.\",\n          statusCode: null,\n          name: \"missing_required_field\"\n        }\n      };\n    }\n    const identifier = options.email ? options.email : options.contactId;\n    const queryString = buildPaginationQuery(options);\n    const url = queryString ? `/contacts/${identifier}/segments?${queryString}` : `/contacts/${identifier}/segments`;\n    const data = await this.resend.get(url);\n    return data;\n  }\n  async add(options) {\n    if (!options.contactId && !options.email) {\n      return {\n        data: null,\n        headers: null,\n        error: {\n          message: \"Missing `id` or `email` field.\",\n          statusCode: null,\n          name: \"missing_required_field\"\n        }\n      };\n    }\n    const identifier = options.email ? options.email : options.contactId;\n    return this.resend.post(\n      `/contacts/${identifier}/segments/${options.segmentId}`\n    );\n  }\n  async remove(options) {\n    if (!options.contactId && !options.email) {\n      return {\n        data: null,\n        headers: null,\n        error: {\n          message: \"Missing `id` or `email` field.\",\n          statusCode: null,\n          name: \"missing_required_field\"\n        }\n      };\n    }\n    const identifier = options.email ? options.email : options.contactId;\n    return this.resend.delete(\n      `/contacts/${identifier}/segments/${options.segmentId}`\n    );\n  }\n};\n\n// src/contacts/topics/contact-topics.ts\nvar ContactTopics = class {\n  constructor(resend) {\n    this.resend = resend;\n  }\n  async update(payload) {\n    if (!payload.id && !payload.email) {\n      return {\n        data: null,\n        headers: null,\n        error: {\n          message: \"Missing `id` or `email` field.\",\n          statusCode: null,\n          name: \"missing_required_field\"\n        }\n      };\n    }\n    const identifier = payload.email ? payload.email : payload.id;\n    return this.resend.patch(\n      `/contacts/${identifier}/topics`,\n      payload.topics\n    );\n  }\n  async list(options) {\n    if (!options.id && !options.email) {\n      return {\n        data: null,\n        headers: null,\n        error: {\n          message: \"Missing `id` or `email` field.\",\n          statusCode: null,\n          name: \"missing_required_field\"\n        }\n      };\n    }\n    const identifier = options.email ? options.email : options.id;\n    const queryString = buildPaginationQuery(options);\n    const url = queryString ? `/contacts/${identifier}/topics?${queryString}` : `/contacts/${identifier}/topics`;\n    return this.resend.get(url);\n  }\n};\n\n// src/contacts/contacts.ts\nvar Contacts = class {\n  constructor(resend) {\n    this.resend = resend;\n    this.topics = new ContactTopics(this.resend);\n    this.segments = new ContactSegments(this.resend);\n  }\n  async create(payload, options = {}) {\n    if (!payload.audienceId) {\n      const data2 = await this.resend.post(\n        \"/contacts\",\n        {\n          unsubscribed: payload.unsubscribed,\n          email: payload.email,\n          first_name: payload.firstName,\n          last_name: payload.lastName,\n          properties: payload.properties\n        },\n        options\n      );\n      return data2;\n    }\n    const data = await this.resend.post(\n      `/audiences/${payload.audienceId}/contacts`,\n      {\n        unsubscribed: payload.unsubscribed,\n        email: payload.email,\n        first_name: payload.firstName,\n        last_name: payload.lastName,\n        properties: payload.properties\n      },\n      options\n    );\n    return data;\n  }\n  async list(options = {}) {\n    if (!(\"audienceId\" in options) || options.audienceId === void 0) {\n      const queryString2 = buildPaginationQuery(options);\n      const url2 = queryString2 ? `/contacts?${queryString2}` : \"/contacts\";\n      const data2 = await this.resend.get(url2);\n      return data2;\n    }\n    const _a = options, { audienceId } = _a, paginationOptions = __objRest(_a, [\"audienceId\"]);\n    const queryString = buildPaginationQuery(paginationOptions);\n    const url = queryString ? `/audiences/${audienceId}/contacts?${queryString}` : `/audiences/${audienceId}/contacts`;\n    const data = await this.resend.get(url);\n    return data;\n  }\n  async get(options) {\n    if (typeof options === \"string\") {\n      return this.resend.get(`/contacts/${options}`);\n    }\n    if (!options.id && !options.email) {\n      return {\n        data: null,\n        headers: null,\n        error: {\n          message: \"Missing `id` or `email` field.\",\n          statusCode: null,\n          name: \"missing_required_field\"\n        }\n      };\n    }\n    if (!options.audienceId) {\n      return this.resend.get(\n        `/contacts/${(options == null ? void 0 : options.email) ? options == null ? void 0 : options.email : options == null ? void 0 : options.id}`\n      );\n    }\n    return this.resend.get(\n      `/audiences/${options.audienceId}/contacts/${(options == null ? void 0 : options.email) ? options == null ? void 0 : options.email : options == null ? void 0 : options.id}`\n    );\n  }\n  async update(options) {\n    if (!options.id && !options.email) {\n      return {\n        data: null,\n        headers: null,\n        error: {\n          message: \"Missing `id` or `email` field.\",\n          statusCode: null,\n          name: \"missing_required_field\"\n        }\n      };\n    }\n    if (!options.audienceId) {\n      const data2 = await this.resend.patch(\n        `/contacts/${(options == null ? void 0 : options.email) ? options == null ? void 0 : options.email : options == null ? void 0 : options.id}`,\n        {\n          unsubscribed: options.unsubscribed,\n          first_name: options.firstName,\n          last_name: options.lastName,\n          properties: options.properties\n        }\n      );\n      return data2;\n    }\n    const data = await this.resend.patch(\n      `/audiences/${options.audienceId}/contacts/${(options == null ? void 0 : options.email) ? options == null ? void 0 : options.email : options == null ? void 0 : options.id}`,\n      {\n        unsubscribed: options.unsubscribed,\n        first_name: options.firstName,\n        last_name: options.lastName,\n        properties: options.properties\n      }\n    );\n    return data;\n  }\n  async remove(payload) {\n    if (typeof payload === \"string\") {\n      return this.resend.delete(\n        `/contacts/${payload}`\n      );\n    }\n    if (!payload.id && !payload.email) {\n      return {\n        data: null,\n        headers: null,\n        error: {\n          message: \"Missing `id` or `email` field.\",\n          statusCode: null,\n          name: \"missing_required_field\"\n        }\n      };\n    }\n    if (!payload.audienceId) {\n      return this.resend.delete(\n        `/contacts/${(payload == null ? void 0 : payload.email) ? payload == null ? void 0 : payload.email : payload == null ? void 0 : payload.id}`\n      );\n    }\n    return this.resend.delete(\n      `/audiences/${payload.audienceId}/contacts/${(payload == null ? void 0 : payload.email) ? payload == null ? void 0 : payload.email : payload == null ? void 0 : payload.id}`\n    );\n  }\n};\n\n// src/common/utils/parse-domain-to-api-options.ts\nfunction parseDomainToApiOptions(domain) {\n  return {\n    name: domain.name,\n    region: domain.region,\n    custom_return_path: domain.customReturnPath\n  };\n}\n\n// src/domains/domains.ts\nvar Domains = class {\n  constructor(resend) {\n    this.resend = resend;\n  }\n  async create(payload, options = {}) {\n    const data = await this.resend.post(\n      \"/domains\",\n      parseDomainToApiOptions(payload),\n      options\n    );\n    return data;\n  }\n  async list(options = {}) {\n    const queryString = buildPaginationQuery(options);\n    const url = queryString ? `/domains?${queryString}` : \"/domains\";\n    const data = await this.resend.get(url);\n    return data;\n  }\n  async get(id) {\n    const data = await this.resend.get(\n      `/domains/${id}`\n    );\n    return data;\n  }\n  async update(payload) {\n    const data = await this.resend.patch(\n      `/domains/${payload.id}`,\n      {\n        click_tracking: payload.clickTracking,\n        open_tracking: payload.openTracking,\n        tls: payload.tls\n      }\n    );\n    return data;\n  }\n  async remove(id) {\n    const data = await this.resend.delete(\n      `/domains/${id}`\n    );\n    return data;\n  }\n  async verify(id) {\n    const data = await this.resend.post(\n      `/domains/${id}/verify`\n    );\n    return data;\n  }\n};\n\n// src/emails/attachments/attachments.ts\nvar Attachments = class {\n  constructor(resend) {\n    this.resend = resend;\n  }\n  async get(options) {\n    const { emailId, id } = options;\n    const data = await this.resend.get(\n      `/emails/${emailId}/attachments/${id}`\n    );\n    return data;\n  }\n  async list(options) {\n    const { emailId } = options;\n    const queryString = buildPaginationQuery(options);\n    const url = queryString ? `/emails/${emailId}/attachments?${queryString}` : `/emails/${emailId}/attachments`;\n    const data = await this.resend.get(url);\n    return data;\n  }\n};\n\n// src/emails/receiving/attachments/attachments.ts\nvar Attachments2 = class {\n  constructor(resend) {\n    this.resend = resend;\n  }\n  async get(options) {\n    const { emailId, id } = options;\n    const data = await this.resend.get(\n      `/emails/receiving/${emailId}/attachments/${id}`\n    );\n    return data;\n  }\n  async list(options) {\n    const { emailId } = options;\n    const queryString = buildPaginationQuery(options);\n    const url = queryString ? `/emails/receiving/${emailId}/attachments?${queryString}` : `/emails/receiving/${emailId}/attachments`;\n    const data = await this.resend.get(url);\n    return data;\n  }\n};\n\n// src/emails/receiving/receiving.ts\nvar Receiving = class {\n  constructor(resend) {\n    this.resend = resend;\n    this.attachments = new Attachments2(resend);\n  }\n  async get(id) {\n    const data = await this.resend.get(\n      `/emails/receiving/${id}`\n    );\n    return data;\n  }\n  async list(options = {}) {\n    const queryString = buildPaginationQuery(options);\n    const url = queryString ? `/emails/receiving?${queryString}` : \"/emails/receiving\";\n    const data = await this.resend.get(url);\n    return data;\n  }\n};\n\n// src/emails/emails.ts\nvar Emails = class {\n  constructor(resend) {\n    this.resend = resend;\n    this.attachments = new Attachments(resend);\n    this.receiving = new Receiving(resend);\n  }\n  async send(payload, options = {}) {\n    return this.create(payload, options);\n  }\n  async create(payload, options = {}) {\n    if (payload.react) {\n      payload.html = await render(payload.react);\n    }\n    const data = await this.resend.post(\n      \"/emails\",\n      parseEmailToApiOptions(payload),\n      options\n    );\n    return data;\n  }\n  async get(id) {\n    const data = await this.resend.get(\n      `/emails/${id}`\n    );\n    return data;\n  }\n  async list(options = {}) {\n    const queryString = buildPaginationQuery(options);\n    const url = queryString ? `/emails?${queryString}` : \"/emails\";\n    const data = await this.resend.get(url);\n    return data;\n  }\n  async update(payload) {\n    const data = await this.resend.patch(\n      `/emails/${payload.id}`,\n      {\n        scheduled_at: payload.scheduledAt\n      }\n    );\n    return data;\n  }\n  async cancel(id) {\n    const data = await this.resend.post(\n      `/emails/${id}/cancel`\n    );\n    return data;\n  }\n};\n\n// src/segments/segments.ts\nvar Segments = class {\n  constructor(resend) {\n    this.resend = resend;\n  }\n  async create(payload, options = {}) {\n    const data = await this.resend.post(\n      \"/segments\",\n      payload,\n      options\n    );\n    return data;\n  }\n  async list(options = {}) {\n    const queryString = buildPaginationQuery(options);\n    const url = queryString ? `/segments?${queryString}` : \"/segments\";\n    const data = await this.resend.get(url);\n    return data;\n  }\n  async get(id) {\n    const data = await this.resend.get(\n      `/segments/${id}`\n    );\n    return data;\n  }\n  async remove(id) {\n    const data = await this.resend.delete(\n      `/segments/${id}`\n    );\n    return data;\n  }\n};\n\n// src/common/utils/get-pagination-query-properties.ts\nfunction getPaginationQueryProperties(options = {}) {\n  const query = new URLSearchParams();\n  if (options.before) query.set(\"before\", options.before);\n  if (options.after) query.set(\"after\", options.after);\n  if (options.limit) query.set(\"limit\", options.limit.toString());\n  return query.size > 0 ? `?${query.toString()}` : \"\";\n}\n\n// src/common/utils/parse-template-to-api-options.ts\nfunction parseVariables(variables) {\n  return variables == null ? void 0 : variables.map((variable) => ({\n    key: variable.key,\n    type: variable.type,\n    fallback_value: variable.fallbackValue\n  }));\n}\nfunction parseTemplateToApiOptions(template) {\n  return {\n    name: \"name\" in template ? template.name : void 0,\n    subject: template.subject,\n    html: template.html,\n    text: template.text,\n    alias: template.alias,\n    from: template.from,\n    reply_to: template.replyTo,\n    variables: parseVariables(template.variables)\n  };\n}\n\n// src/templates/chainable-template-result.ts\nvar ChainableTemplateResult = class {\n  constructor(promise, publishFn) {\n    this.promise = promise;\n    this.publishFn = publishFn;\n  }\n  // If user calls `then` or only awaits for the result of create() or duplicate(), the behavior should be\n  // exactly as if they called create() or duplicate() directly. This will act as a normal promise\n  // biome-ignore lint/suspicious/noThenProperty: This class intentionally implements PromiseLike\n  then(onfulfilled, onrejected) {\n    return this.promise.then(onfulfilled, onrejected);\n  }\n  async publish() {\n    const { data, error } = await this.promise;\n    if (error) {\n      return {\n        data: null,\n        headers: null,\n        error\n      };\n    }\n    return this.publishFn(data.id);\n  }\n};\n\n// src/templates/templates.ts\nvar Templates = class {\n  constructor(resend) {\n    this.resend = resend;\n  }\n  create(payload) {\n    const createPromise = this.performCreate(payload);\n    return new ChainableTemplateResult(createPromise, this.publish.bind(this));\n  }\n  // This creation process is being done separately from the public create so that\n  // the user can chain the publish operation after the create operation. Otherwise, due\n  // to the async nature of the renderAsync, the return type would be\n  // Promise<ChainableTemplateResult<CreateTemplateResponse>> which wouldn't be chainable.\n  async performCreate(payload) {\n    if (payload.react) {\n      if (!this.renderAsync) {\n        try {\n          const { renderAsync } = await Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/next@15.2.4_react-dom@19.2.0_react@19.2.0__react@19.2.0\"), __webpack_require__.e(\"vendor-chunks/entities@4.5.0\"), __webpack_require__.e(\"vendor-chunks/domutils@3.2.2\"), __webpack_require__.e(\"vendor-chunks/htmlparser2@8.0.2\"), __webpack_require__.e(\"vendor-chunks/prettier@3.6.2\"), __webpack_require__.e(\"vendor-chunks/peberminta@0.9.0\"), __webpack_require__.e(\"vendor-chunks/domhandler@5.0.3\"), __webpack_require__.e(\"vendor-chunks/dom-serializer@2.0.0\"), __webpack_require__.e(\"vendor-chunks/selderee@0.11.0\"), __webpack_require__.e(\"vendor-chunks/parseley@0.12.1\"), __webpack_require__.e(\"vendor-chunks/leac@0.6.0\"), __webpack_require__.e(\"vendor-chunks/html-to-text@9.0.5\"), __webpack_require__.e(\"vendor-chunks/domelementtype@2.3.0\"), __webpack_require__.e(\"vendor-chunks/@selderee+plugin-htmlparser2@0.11.0\"), __webpack_require__.e(\"vendor-chunks/@react-email+render@1.4.0_react-dom@19.2.0_react@19.2.0__react@19.2.0\"), __webpack_require__.e(\"vendor-chunks/deepmerge@4.3.1\")]).then(__webpack_require__.bind(__webpack_require__, /*! @react-email/render */ \"(action-browser)/./node_modules/.pnpm/@react-email+render@1.4.0_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/@react-email/render/dist/node/index.mjs\"));\n          this.renderAsync = renderAsync;\n        } catch (e) {\n          throw new Error(\n            \"Failed to render React component. Make sure to install `@react-email/render`\"\n          );\n        }\n      }\n      payload.html = await this.renderAsync(\n        payload.react\n      );\n    }\n    return this.resend.post(\n      \"/templates\",\n      parseTemplateToApiOptions(payload)\n    );\n  }\n  async remove(identifier) {\n    const data = await this.resend.delete(\n      `/templates/${identifier}`\n    );\n    return data;\n  }\n  async get(identifier) {\n    const data = await this.resend.get(\n      `/templates/${identifier}`\n    );\n    return data;\n  }\n  async list(options = {}) {\n    return this.resend.get(\n      `/templates${getPaginationQueryProperties(options)}`\n    );\n  }\n  duplicate(identifier) {\n    const promiseDuplicate = this.resend.post(\n      `/templates/${identifier}/duplicate`\n    );\n    return new ChainableTemplateResult(\n      promiseDuplicate,\n      this.publish.bind(this)\n    );\n  }\n  async publish(identifier) {\n    const data = await this.resend.post(\n      `/templates/${identifier}/publish`\n    );\n    return data;\n  }\n  async update(identifier, payload) {\n    const data = await this.resend.patch(\n      `/templates/${identifier}`,\n      parseTemplateToApiOptions(payload)\n    );\n    return data;\n  }\n};\n\n// src/topics/topics.ts\nvar Topics = class {\n  constructor(resend) {\n    this.resend = resend;\n  }\n  async create(payload) {\n    const _a = payload, { defaultSubscription } = _a, body = __objRest(_a, [\"defaultSubscription\"]);\n    const data = await this.resend.post(\"/topics\", __spreadProps(__spreadValues({}, body), {\n      default_subscription: defaultSubscription\n    }));\n    return data;\n  }\n  async list() {\n    const data = await this.resend.get(\"/topics\");\n    return data;\n  }\n  async get(id) {\n    if (!id) {\n      return {\n        data: null,\n        headers: null,\n        error: {\n          message: \"Missing `id` field.\",\n          statusCode: null,\n          name: \"missing_required_field\"\n        }\n      };\n    }\n    const data = await this.resend.get(\n      `/topics/${id}`\n    );\n    return data;\n  }\n  async update(payload) {\n    if (!payload.id) {\n      return {\n        data: null,\n        headers: null,\n        error: {\n          message: \"Missing `id` field.\",\n          statusCode: null,\n          name: \"missing_required_field\"\n        }\n      };\n    }\n    const data = await this.resend.patch(\n      `/topics/${payload.id}`,\n      payload\n    );\n    return data;\n  }\n  async remove(id) {\n    if (!id) {\n      return {\n        data: null,\n        headers: null,\n        error: {\n          message: \"Missing `id` field.\",\n          statusCode: null,\n          name: \"missing_required_field\"\n        }\n      };\n    }\n    const data = await this.resend.delete(\n      `/topics/${id}`\n    );\n    return data;\n  }\n};\n\n// src/webhooks/webhooks.ts\n\nvar Webhooks = class {\n  constructor(resend) {\n    this.resend = resend;\n  }\n  async create(payload, options = {}) {\n    const data = await this.resend.post(\n      \"/webhooks\",\n      payload,\n      options\n    );\n    return data;\n  }\n  async get(id) {\n    const data = await this.resend.get(\n      `/webhooks/${id}`\n    );\n    return data;\n  }\n  async list(options = {}) {\n    const queryString = buildPaginationQuery(options);\n    const url = queryString ? `/webhooks?${queryString}` : \"/webhooks\";\n    const data = await this.resend.get(url);\n    return data;\n  }\n  async update(id, payload) {\n    const data = await this.resend.patch(\n      `/webhooks/${id}`,\n      payload\n    );\n    return data;\n  }\n  async remove(id) {\n    const data = await this.resend.delete(\n      `/webhooks/${id}`\n    );\n    return data;\n  }\n  verify(payload) {\n    const webhook = new svix__WEBPACK_IMPORTED_MODULE_0__.Webhook(payload.webhookSecret);\n    return webhook.verify(payload.payload, {\n      \"svix-id\": payload.headers.id,\n      \"svix-timestamp\": payload.headers.timestamp,\n      \"svix-signature\": payload.headers.signature\n    });\n  }\n};\n\n// src/resend.ts\nvar defaultBaseUrl = \"https://api.resend.com\";\nvar defaultUserAgent = `resend-node:${version}`;\nvar baseUrl = typeof process !== \"undefined\" && process.env ? process.env.RESEND_BASE_URL || defaultBaseUrl : defaultBaseUrl;\nvar userAgent = typeof process !== \"undefined\" && process.env ? process.env.RESEND_USER_AGENT || defaultUserAgent : defaultUserAgent;\nvar Resend = class {\n  constructor(key) {\n    this.key = key;\n    this.apiKeys = new ApiKeys(this);\n    this.segments = new Segments(this);\n    /**\n     * @deprecated Use segments instead\n     */\n    this.audiences = this.segments;\n    this.batch = new Batch(this);\n    this.broadcasts = new Broadcasts(this);\n    this.contacts = new Contacts(this);\n    this.contactProperties = new ContactProperties(this);\n    this.domains = new Domains(this);\n    this.emails = new Emails(this);\n    this.webhooks = new Webhooks(this);\n    this.templates = new Templates(this);\n    this.topics = new Topics(this);\n    if (!key) {\n      if (typeof process !== \"undefined\" && process.env) {\n        this.key = process.env.RESEND_API_KEY;\n      }\n      if (!this.key) {\n        throw new Error(\n          'Missing API key. Pass it to the constructor `new Resend(\"re_123\")`'\n        );\n      }\n    }\n    this.headers = new Headers({\n      Authorization: `Bearer ${this.key}`,\n      \"User-Agent\": userAgent,\n      \"Content-Type\": \"application/json\"\n    });\n  }\n  async fetchRequest(path, options = {}) {\n    try {\n      const response = await fetch(`${baseUrl}${path}`, options);\n      if (!response.ok) {\n        try {\n          const rawError = await response.text();\n          return {\n            data: null,\n            error: JSON.parse(rawError),\n            headers: Object.fromEntries(response.headers.entries())\n          };\n        } catch (err) {\n          if (err instanceof SyntaxError) {\n            return {\n              data: null,\n              error: {\n                name: \"application_error\",\n                statusCode: response.status,\n                message: \"Internal server error. We are unable to process your request right now, please try again later.\"\n              },\n              headers: Object.fromEntries(response.headers.entries())\n            };\n          }\n          const error = {\n            message: response.statusText,\n            statusCode: response.status,\n            name: \"application_error\"\n          };\n          if (err instanceof Error) {\n            return {\n              data: null,\n              error: __spreadProps(__spreadValues({}, error), { message: err.message }),\n              headers: Object.fromEntries(response.headers.entries())\n            };\n          }\n          return {\n            data: null,\n            error,\n            headers: Object.fromEntries(response.headers.entries())\n          };\n        }\n      }\n      const data = await response.json();\n      return {\n        data,\n        error: null,\n        headers: Object.fromEntries(response.headers.entries())\n      };\n    } catch (e) {\n      return {\n        data: null,\n        error: {\n          name: \"application_error\",\n          statusCode: null,\n          message: \"Unable to fetch data. The request could not be resolved.\"\n        },\n        headers: null\n      };\n    }\n  }\n  async post(path, entity, options = {}) {\n    const headers = new Headers(this.headers);\n    if (options.headers) {\n      for (const [key, value] of new Headers(options.headers).entries()) {\n        headers.set(key, value);\n      }\n    }\n    if (options.idempotencyKey) {\n      headers.set(\"Idempotency-Key\", options.idempotencyKey);\n    }\n    const requestOptions = __spreadProps(__spreadValues({\n      method: \"POST\",\n      body: JSON.stringify(entity)\n    }, options), {\n      headers\n    });\n    return this.fetchRequest(path, requestOptions);\n  }\n  async get(path, options = {}) {\n    const headers = new Headers(this.headers);\n    if (options.headers) {\n      for (const [key, value] of new Headers(options.headers).entries()) {\n        headers.set(key, value);\n      }\n    }\n    const requestOptions = __spreadProps(__spreadValues({\n      method: \"GET\"\n    }, options), {\n      headers\n    });\n    return this.fetchRequest(path, requestOptions);\n  }\n  async put(path, entity, options = {}) {\n    const headers = new Headers(this.headers);\n    if (options.headers) {\n      for (const [key, value] of new Headers(options.headers).entries()) {\n        headers.set(key, value);\n      }\n    }\n    const requestOptions = __spreadProps(__spreadValues({\n      method: \"PUT\",\n      body: JSON.stringify(entity)\n    }, options), {\n      headers\n    });\n    return this.fetchRequest(path, requestOptions);\n  }\n  async patch(path, entity, options = {}) {\n    const headers = new Headers(this.headers);\n    if (options.headers) {\n      for (const [key, value] of new Headers(options.headers).entries()) {\n        headers.set(key, value);\n      }\n    }\n    const requestOptions = __spreadProps(__spreadValues({\n      method: \"PATCH\",\n      body: JSON.stringify(entity)\n    }, options), {\n      headers\n    });\n    return this.fetchRequest(path, requestOptions);\n  }\n  async delete(path, query) {\n    const requestOptions = {\n      method: \"DELETE\",\n      body: JSON.stringify(query),\n      headers: this.headers\n    };\n    return this.fetchRequest(path, requestOptions);\n  }\n};\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9yZXNlbmRANi40LjFfQHJlYWN0LWVtYWlsK3JlbmRlckAxLjQuMF9yZWFjdC1kb21AMTkuMi4wX3JlYWN0QDE5LjIuMF9fcmVhY3RAMTkuMi4wXy9ub2RlX21vZHVsZXMvcmVzZW5kL2Rpc3QvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEVBQThFLDZEQUE2RDtBQUMzSTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBLDJDQUEyQyxZQUFZO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsR0FBRztBQUN0QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPLGtCQUFrQixRQUFRLDB3Q0FBNkI7QUFDOUQsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FB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TjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUM7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esc0NBQXNDO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esd0NBQXdDO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0UiLCJzb3VyY2VzIjpbIi9Vc2Vycy9ob3dkeS9kZXYvd2VicGFnZS9ub2RlX21vZHVsZXMvLnBucG0vcmVzZW5kQDYuNC4xX0ByZWFjdC1lbWFpbCtyZW5kZXJAMS40LjBfcmVhY3QtZG9tQDE5LjIuMF9yZWFjdEAxOS4yLjBfX3JlYWN0QDE5LjIuMF8vbm9kZV9tb2R1bGVzL3Jlc2VuZC9kaXN0L2luZGV4Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19kZWZQcm9wID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xudmFyIF9fZGVmUHJvcHMgPSBPYmplY3QuZGVmaW5lUHJvcGVydGllcztcbnZhciBfX2dldE93blByb3BEZXNjcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzO1xudmFyIF9fZ2V0T3duUHJvcFN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzO1xudmFyIF9faGFzT3duUHJvcCA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG52YXIgX19wcm9wSXNFbnVtID0gT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZTtcbnZhciBfX2RlZk5vcm1hbFByb3AgPSAob2JqLCBrZXksIHZhbHVlKSA9PiBrZXkgaW4gb2JqID8gX19kZWZQcm9wKG9iaiwga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUsIHZhbHVlIH0pIDogb2JqW2tleV0gPSB2YWx1ZTtcbnZhciBfX3NwcmVhZFZhbHVlcyA9IChhLCBiKSA9PiB7XG4gIGZvciAodmFyIHByb3AgaW4gYiB8fCAoYiA9IHt9KSlcbiAgICBpZiAoX19oYXNPd25Qcm9wLmNhbGwoYiwgcHJvcCkpXG4gICAgICBfX2RlZk5vcm1hbFByb3AoYSwgcHJvcCwgYltwcm9wXSk7XG4gIGlmIChfX2dldE93blByb3BTeW1ib2xzKVxuICAgIGZvciAodmFyIHByb3Agb2YgX19nZXRPd25Qcm9wU3ltYm9scyhiKSkge1xuICAgICAgaWYgKF9fcHJvcElzRW51bS5jYWxsKGIsIHByb3ApKVxuICAgICAgICBfX2RlZk5vcm1hbFByb3AoYSwgcHJvcCwgYltwcm9wXSk7XG4gICAgfVxuICByZXR1cm4gYTtcbn07XG52YXIgX19zcHJlYWRQcm9wcyA9IChhLCBiKSA9PiBfX2RlZlByb3BzKGEsIF9fZ2V0T3duUHJvcERlc2NzKGIpKTtcbnZhciBfX29ialJlc3QgPSAoc291cmNlLCBleGNsdWRlKSA9PiB7XG4gIHZhciB0YXJnZXQgPSB7fTtcbiAgZm9yICh2YXIgcHJvcCBpbiBzb3VyY2UpXG4gICAgaWYgKF9faGFzT3duUHJvcC5jYWxsKHNvdXJjZSwgcHJvcCkgJiYgZXhjbHVkZS5pbmRleE9mKHByb3ApIDwgMClcbiAgICAgIHRhcmdldFtwcm9wXSA9IHNvdXJjZVtwcm9wXTtcbiAgaWYgKHNvdXJjZSAhPSBudWxsICYmIF9fZ2V0T3duUHJvcFN5bWJvbHMpXG4gICAgZm9yICh2YXIgcHJvcCBvZiBfX2dldE93blByb3BTeW1ib2xzKHNvdXJjZSkpIHtcbiAgICAgIGlmIChleGNsdWRlLmluZGV4T2YocHJvcCkgPCAwICYmIF9fcHJvcElzRW51bS5jYWxsKHNvdXJjZSwgcHJvcCkpXG4gICAgICAgIHRhcmdldFtwcm9wXSA9IHNvdXJjZVtwcm9wXTtcbiAgICB9XG4gIHJldHVybiB0YXJnZXQ7XG59O1xuXG4vLyBwYWNrYWdlLmpzb25cbnZhciB2ZXJzaW9uID0gXCI2LjQuMVwiO1xuXG4vLyBzcmMvY29tbW9uL3V0aWxzL2J1aWxkLXBhZ2luYXRpb24tcXVlcnkudHNcbmZ1bmN0aW9uIGJ1aWxkUGFnaW5hdGlvblF1ZXJ5KG9wdGlvbnMpIHtcbiAgY29uc3Qgc2VhcmNoUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuICBpZiAob3B0aW9ucy5saW1pdCAhPT0gdm9pZCAwKSB7XG4gICAgc2VhcmNoUGFyYW1zLnNldChcImxpbWl0XCIsIG9wdGlvbnMubGltaXQudG9TdHJpbmcoKSk7XG4gIH1cbiAgaWYgKFwiYWZ0ZXJcIiBpbiBvcHRpb25zICYmIG9wdGlvbnMuYWZ0ZXIgIT09IHZvaWQgMCkge1xuICAgIHNlYXJjaFBhcmFtcy5zZXQoXCJhZnRlclwiLCBvcHRpb25zLmFmdGVyKTtcbiAgfVxuICBpZiAoXCJiZWZvcmVcIiBpbiBvcHRpb25zICYmIG9wdGlvbnMuYmVmb3JlICE9PSB2b2lkIDApIHtcbiAgICBzZWFyY2hQYXJhbXMuc2V0KFwiYmVmb3JlXCIsIG9wdGlvbnMuYmVmb3JlKTtcbiAgfVxuICByZXR1cm4gc2VhcmNoUGFyYW1zLnRvU3RyaW5nKCk7XG59XG5cbi8vIHNyYy9hcGkta2V5cy9hcGkta2V5cy50c1xudmFyIEFwaUtleXMgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKHJlc2VuZCkge1xuICAgIHRoaXMucmVzZW5kID0gcmVzZW5kO1xuICB9XG4gIGFzeW5jIGNyZWF0ZShwYXlsb2FkLCBvcHRpb25zID0ge30pIHtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQucG9zdChcbiAgICAgIFwiL2FwaS1rZXlzXCIsXG4gICAgICBwYXlsb2FkLFxuICAgICAgb3B0aW9uc1xuICAgICk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbiAgYXN5bmMgbGlzdChvcHRpb25zID0ge30pIHtcbiAgICBjb25zdCBxdWVyeVN0cmluZyA9IGJ1aWxkUGFnaW5hdGlvblF1ZXJ5KG9wdGlvbnMpO1xuICAgIGNvbnN0IHVybCA9IHF1ZXJ5U3RyaW5nID8gYC9hcGkta2V5cz8ke3F1ZXJ5U3RyaW5nfWAgOiBcIi9hcGkta2V5c1wiO1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLnJlc2VuZC5nZXQodXJsKTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuICBhc3luYyByZW1vdmUoaWQpIHtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQuZGVsZXRlKFxuICAgICAgYC9hcGkta2V5cy8ke2lkfWBcbiAgICApO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG59O1xuXG4vLyBzcmMvY29tbW9uL3V0aWxzL3BhcnNlLWVtYWlsLXRvLWFwaS1vcHRpb25zLnRzXG5mdW5jdGlvbiBwYXJzZUF0dGFjaG1lbnRzKGF0dGFjaG1lbnRzKSB7XG4gIHJldHVybiBhdHRhY2htZW50cyA9PSBudWxsID8gdm9pZCAwIDogYXR0YWNobWVudHMubWFwKChhdHRhY2htZW50KSA9PiAoe1xuICAgIGNvbnRlbnQ6IGF0dGFjaG1lbnQuY29udGVudCxcbiAgICBmaWxlbmFtZTogYXR0YWNobWVudC5maWxlbmFtZSxcbiAgICBwYXRoOiBhdHRhY2htZW50LnBhdGgsXG4gICAgY29udGVudF90eXBlOiBhdHRhY2htZW50LmNvbnRlbnRUeXBlLFxuICAgIGNvbnRlbnRfaWQ6IGF0dGFjaG1lbnQuY29udGVudElkXG4gIH0pKTtcbn1cbmZ1bmN0aW9uIHBhcnNlRW1haWxUb0FwaU9wdGlvbnMoZW1haWwpIHtcbiAgcmV0dXJuIHtcbiAgICBhdHRhY2htZW50czogcGFyc2VBdHRhY2htZW50cyhlbWFpbC5hdHRhY2htZW50cyksXG4gICAgYmNjOiBlbWFpbC5iY2MsXG4gICAgY2M6IGVtYWlsLmNjLFxuICAgIGZyb206IGVtYWlsLmZyb20sXG4gICAgaGVhZGVyczogZW1haWwuaGVhZGVycyxcbiAgICBodG1sOiBlbWFpbC5odG1sLFxuICAgIHJlcGx5X3RvOiBlbWFpbC5yZXBseVRvLFxuICAgIHNjaGVkdWxlZF9hdDogZW1haWwuc2NoZWR1bGVkQXQsXG4gICAgc3ViamVjdDogZW1haWwuc3ViamVjdCxcbiAgICB0YWdzOiBlbWFpbC50YWdzLFxuICAgIHRleHQ6IGVtYWlsLnRleHQsXG4gICAgdG86IGVtYWlsLnRvLFxuICAgIHRlbXBsYXRlOiBlbWFpbC50ZW1wbGF0ZSA/IHtcbiAgICAgIGlkOiBlbWFpbC50ZW1wbGF0ZS5pZCxcbiAgICAgIHZhcmlhYmxlczogZW1haWwudGVtcGxhdGUudmFyaWFibGVzXG4gICAgfSA6IHZvaWQgMCxcbiAgICB0b3BpY19pZDogZW1haWwudG9waWNJZFxuICB9O1xufVxuXG4vLyBzcmMvcmVuZGVyLnRzXG5hc3luYyBmdW5jdGlvbiByZW5kZXIobm9kZSkge1xuICBsZXQgcmVuZGVyMjtcbiAgdHJ5IHtcbiAgICAoeyByZW5kZXI6IHJlbmRlcjIgfSA9IGF3YWl0IGltcG9ydChcIkByZWFjdC1lbWFpbC9yZW5kZXJcIikpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgXCJGYWlsZWQgdG8gcmVuZGVyIFJlYWN0IGNvbXBvbmVudC4gTWFrZSBzdXJlIHRvIGluc3RhbGwgYEByZWFjdC1lbWFpbC9yZW5kZXJgIG9yIGBAcmVhY3QtZW1haWwvY29tcG9uZW50c2AuXCJcbiAgICApO1xuICB9XG4gIHJldHVybiByZW5kZXIyKG5vZGUpO1xufVxuXG4vLyBzcmMvYmF0Y2gvYmF0Y2gudHNcbnZhciBCYXRjaCA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IocmVzZW5kKSB7XG4gICAgdGhpcy5yZXNlbmQgPSByZXNlbmQ7XG4gIH1cbiAgYXN5bmMgc2VuZChwYXlsb2FkLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlKHBheWxvYWQsIG9wdGlvbnMpO1xuICB9XG4gIGFzeW5jIGNyZWF0ZShwYXlsb2FkLCBvcHRpb25zKSB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IGVtYWlscyA9IFtdO1xuICAgIGZvciAoY29uc3QgZW1haWwgb2YgcGF5bG9hZCkge1xuICAgICAgaWYgKGVtYWlsLnJlYWN0KSB7XG4gICAgICAgIGVtYWlsLmh0bWwgPSBhd2FpdCByZW5kZXIoZW1haWwucmVhY3QpO1xuICAgICAgICBlbWFpbC5yZWFjdCA9IHZvaWQgMDtcbiAgICAgIH1cbiAgICAgIGVtYWlscy5wdXNoKHBhcnNlRW1haWxUb0FwaU9wdGlvbnMoZW1haWwpKTtcbiAgICB9XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMucmVzZW5kLnBvc3QoXG4gICAgICBcIi9lbWFpbHMvYmF0Y2hcIixcbiAgICAgIGVtYWlscyxcbiAgICAgIF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIG9wdGlvbnMpLCB7XG4gICAgICAgIGhlYWRlcnM6IF9fc3ByZWFkVmFsdWVzKHtcbiAgICAgICAgICBcIngtYmF0Y2gtdmFsaWRhdGlvblwiOiAoX2EgPSBvcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBvcHRpb25zLmJhdGNoVmFsaWRhdGlvbikgIT0gbnVsbCA/IF9hIDogXCJzdHJpY3RcIlxuICAgICAgICB9LCBvcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBvcHRpb25zLmhlYWRlcnMpXG4gICAgICB9KVxuICAgICk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbn07XG5cbi8vIHNyYy9icm9hZGNhc3RzL2Jyb2FkY2FzdHMudHNcbnZhciBCcm9hZGNhc3RzID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcihyZXNlbmQpIHtcbiAgICB0aGlzLnJlc2VuZCA9IHJlc2VuZDtcbiAgfVxuICBhc3luYyBjcmVhdGUocGF5bG9hZCwgb3B0aW9ucyA9IHt9KSB7XG4gICAgaWYgKHBheWxvYWQucmVhY3QpIHtcbiAgICAgIHBheWxvYWQuaHRtbCA9IGF3YWl0IHJlbmRlcihwYXlsb2FkLnJlYWN0KTtcbiAgICB9XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMucmVzZW5kLnBvc3QoXG4gICAgICBcIi9icm9hZGNhc3RzXCIsXG4gICAgICB7XG4gICAgICAgIG5hbWU6IHBheWxvYWQubmFtZSxcbiAgICAgICAgc2VnbWVudF9pZDogcGF5bG9hZC5zZWdtZW50SWQsXG4gICAgICAgIGF1ZGllbmNlX2lkOiBwYXlsb2FkLmF1ZGllbmNlSWQsXG4gICAgICAgIHByZXZpZXdfdGV4dDogcGF5bG9hZC5wcmV2aWV3VGV4dCxcbiAgICAgICAgZnJvbTogcGF5bG9hZC5mcm9tLFxuICAgICAgICBodG1sOiBwYXlsb2FkLmh0bWwsXG4gICAgICAgIHJlcGx5X3RvOiBwYXlsb2FkLnJlcGx5VG8sXG4gICAgICAgIHN1YmplY3Q6IHBheWxvYWQuc3ViamVjdCxcbiAgICAgICAgdGV4dDogcGF5bG9hZC50ZXh0LFxuICAgICAgICB0b3BpY19pZDogcGF5bG9hZC50b3BpY0lkXG4gICAgICB9LFxuICAgICAgb3B0aW9uc1xuICAgICk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbiAgYXN5bmMgc2VuZChpZCwgcGF5bG9hZCkge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLnJlc2VuZC5wb3N0KFxuICAgICAgYC9icm9hZGNhc3RzLyR7aWR9L3NlbmRgLFxuICAgICAgeyBzY2hlZHVsZWRfYXQ6IHBheWxvYWQgPT0gbnVsbCA/IHZvaWQgMCA6IHBheWxvYWQuc2NoZWR1bGVkQXQgfVxuICAgICk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbiAgYXN5bmMgbGlzdChvcHRpb25zID0ge30pIHtcbiAgICBjb25zdCBxdWVyeVN0cmluZyA9IGJ1aWxkUGFnaW5hdGlvblF1ZXJ5KG9wdGlvbnMpO1xuICAgIGNvbnN0IHVybCA9IHF1ZXJ5U3RyaW5nID8gYC9icm9hZGNhc3RzPyR7cXVlcnlTdHJpbmd9YCA6IFwiL2Jyb2FkY2FzdHNcIjtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQuZ2V0KHVybCk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbiAgYXN5bmMgZ2V0KGlkKSB7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMucmVzZW5kLmdldChcbiAgICAgIGAvYnJvYWRjYXN0cy8ke2lkfWBcbiAgICApO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG4gIGFzeW5jIHJlbW92ZShpZCkge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLnJlc2VuZC5kZWxldGUoXG4gICAgICBgL2Jyb2FkY2FzdHMvJHtpZH1gXG4gICAgKTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuICBhc3luYyB1cGRhdGUoaWQsIHBheWxvYWQpIHtcbiAgICBpZiAocGF5bG9hZC5yZWFjdCkge1xuICAgICAgcGF5bG9hZC5odG1sID0gYXdhaXQgcmVuZGVyKHBheWxvYWQucmVhY3QpO1xuICAgIH1cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQucGF0Y2goXG4gICAgICBgL2Jyb2FkY2FzdHMvJHtpZH1gLFxuICAgICAge1xuICAgICAgICBuYW1lOiBwYXlsb2FkLm5hbWUsXG4gICAgICAgIHNlZ21lbnRfaWQ6IHBheWxvYWQuc2VnbWVudElkLFxuICAgICAgICBhdWRpZW5jZV9pZDogcGF5bG9hZC5hdWRpZW5jZUlkLFxuICAgICAgICBmcm9tOiBwYXlsb2FkLmZyb20sXG4gICAgICAgIGh0bWw6IHBheWxvYWQuaHRtbCxcbiAgICAgICAgdGV4dDogcGF5bG9hZC50ZXh0LFxuICAgICAgICBzdWJqZWN0OiBwYXlsb2FkLnN1YmplY3QsXG4gICAgICAgIHJlcGx5X3RvOiBwYXlsb2FkLnJlcGx5VG8sXG4gICAgICAgIHByZXZpZXdfdGV4dDogcGF5bG9hZC5wcmV2aWV3VGV4dCxcbiAgICAgICAgdG9waWNfaWQ6IHBheWxvYWQudG9waWNJZFxuICAgICAgfVxuICAgICk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbn07XG5cbi8vIHNyYy9jb21tb24vdXRpbHMvcGFyc2UtY29udGFjdC1wcm9wZXJ0aWVzLXRvLWFwaS1vcHRpb25zLnRzXG5mdW5jdGlvbiBwYXJzZUNvbnRhY3RQcm9wZXJ0eUZyb21BcGkoY29udGFjdFByb3BlcnR5KSB7XG4gIHJldHVybiB7XG4gICAgaWQ6IGNvbnRhY3RQcm9wZXJ0eS5pZCxcbiAgICBrZXk6IGNvbnRhY3RQcm9wZXJ0eS5rZXksXG4gICAgY3JlYXRlZEF0OiBjb250YWN0UHJvcGVydHkuY3JlYXRlZF9hdCxcbiAgICB0eXBlOiBjb250YWN0UHJvcGVydHkudHlwZSxcbiAgICBmYWxsYmFja1ZhbHVlOiBjb250YWN0UHJvcGVydHkuZmFsbGJhY2tfdmFsdWVcbiAgfTtcbn1cbmZ1bmN0aW9uIHBhcnNlQ29udGFjdFByb3BlcnR5VG9BcGlPcHRpb25zKGNvbnRhY3RQcm9wZXJ0eSkge1xuICBpZiAoXCJrZXlcIiBpbiBjb250YWN0UHJvcGVydHkpIHtcbiAgICByZXR1cm4ge1xuICAgICAga2V5OiBjb250YWN0UHJvcGVydHkua2V5LFxuICAgICAgdHlwZTogY29udGFjdFByb3BlcnR5LnR5cGUsXG4gICAgICBmYWxsYmFja192YWx1ZTogY29udGFjdFByb3BlcnR5LmZhbGxiYWNrVmFsdWVcbiAgICB9O1xuICB9XG4gIHJldHVybiB7XG4gICAgZmFsbGJhY2tfdmFsdWU6IGNvbnRhY3RQcm9wZXJ0eS5mYWxsYmFja1ZhbHVlXG4gIH07XG59XG5cbi8vIHNyYy9jb250YWN0LXByb3BlcnRpZXMvY29udGFjdC1wcm9wZXJ0aWVzLnRzXG52YXIgQ29udGFjdFByb3BlcnRpZXMgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKHJlc2VuZCkge1xuICAgIHRoaXMucmVzZW5kID0gcmVzZW5kO1xuICB9XG4gIGFzeW5jIGNyZWF0ZShvcHRpb25zKSB7XG4gICAgY29uc3QgYXBpT3B0aW9ucyA9IHBhcnNlQ29udGFjdFByb3BlcnR5VG9BcGlPcHRpb25zKG9wdGlvbnMpO1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLnJlc2VuZC5wb3N0KFxuICAgICAgXCIvY29udGFjdC1wcm9wZXJ0aWVzXCIsXG4gICAgICBhcGlPcHRpb25zXG4gICAgKTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuICBhc3luYyBsaXN0KG9wdGlvbnMgPSB7fSkge1xuICAgIGNvbnN0IHF1ZXJ5U3RyaW5nID0gYnVpbGRQYWdpbmF0aW9uUXVlcnkob3B0aW9ucyk7XG4gICAgY29uc3QgdXJsID0gcXVlcnlTdHJpbmcgPyBgL2NvbnRhY3QtcHJvcGVydGllcz8ke3F1ZXJ5U3RyaW5nfWAgOiBcIi9jb250YWN0LXByb3BlcnRpZXNcIjtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMucmVzZW5kLmdldCh1cmwpO1xuICAgIGlmIChyZXNwb25zZS5kYXRhKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBkYXRhOiBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCByZXNwb25zZS5kYXRhKSwge1xuICAgICAgICAgIGRhdGE6IHJlc3BvbnNlLmRhdGEuZGF0YS5tYXAoXG4gICAgICAgICAgICAoYXBpQ29udGFjdFByb3BlcnR5KSA9PiBwYXJzZUNvbnRhY3RQcm9wZXJ0eUZyb21BcGkoYXBpQ29udGFjdFByb3BlcnR5KVxuICAgICAgICAgIClcbiAgICAgICAgfSksXG4gICAgICAgIGhlYWRlcnM6IHJlc3BvbnNlLmhlYWRlcnMsXG4gICAgICAgIGVycm9yOiBudWxsXG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gcmVzcG9uc2U7XG4gIH1cbiAgYXN5bmMgZ2V0KGlkKSB7XG4gICAgaWYgKCFpZCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgaGVhZGVyczogbnVsbCxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBtZXNzYWdlOiBcIk1pc3NpbmcgYGlkYCBmaWVsZC5cIixcbiAgICAgICAgICBzdGF0dXNDb2RlOiBudWxsLFxuICAgICAgICAgIG5hbWU6IFwibWlzc2luZ19yZXF1aXJlZF9maWVsZFwiXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5yZXNlbmQuZ2V0KFxuICAgICAgYC9jb250YWN0LXByb3BlcnRpZXMvJHtpZH1gXG4gICAgKTtcbiAgICBpZiAocmVzcG9uc2UuZGF0YSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZGF0YTogX19zcHJlYWRWYWx1ZXMoe1xuICAgICAgICAgIG9iamVjdDogXCJjb250YWN0X3Byb3BlcnR5XCJcbiAgICAgICAgfSwgcGFyc2VDb250YWN0UHJvcGVydHlGcm9tQXBpKHJlc3BvbnNlLmRhdGEpKSxcbiAgICAgICAgaGVhZGVyczogcmVzcG9uc2UuaGVhZGVycyxcbiAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiByZXNwb25zZTtcbiAgfVxuICBhc3luYyB1cGRhdGUocGF5bG9hZCkge1xuICAgIGlmICghcGF5bG9hZC5pZCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgaGVhZGVyczogbnVsbCxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBtZXNzYWdlOiBcIk1pc3NpbmcgYGlkYCBmaWVsZC5cIixcbiAgICAgICAgICBzdGF0dXNDb2RlOiBudWxsLFxuICAgICAgICAgIG5hbWU6IFwibWlzc2luZ19yZXF1aXJlZF9maWVsZFwiXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICAgIGNvbnN0IGFwaU9wdGlvbnMgPSBwYXJzZUNvbnRhY3RQcm9wZXJ0eVRvQXBpT3B0aW9ucyhwYXlsb2FkKTtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQucGF0Y2goXG4gICAgICBgL2NvbnRhY3QtcHJvcGVydGllcy8ke3BheWxvYWQuaWR9YCxcbiAgICAgIGFwaU9wdGlvbnNcbiAgICApO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG4gIGFzeW5jIHJlbW92ZShpZCkge1xuICAgIGlmICghaWQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgIGhlYWRlcnM6IG51bGwsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgbWVzc2FnZTogXCJNaXNzaW5nIGBpZGAgZmllbGQuXCIsXG4gICAgICAgICAgc3RhdHVzQ29kZTogbnVsbCxcbiAgICAgICAgICBuYW1lOiBcIm1pc3NpbmdfcmVxdWlyZWRfZmllbGRcIlxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQuZGVsZXRlKFxuICAgICAgYC9jb250YWN0LXByb3BlcnRpZXMvJHtpZH1gXG4gICAgKTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxufTtcblxuLy8gc3JjL2NvbnRhY3RzL3NlZ21lbnRzL2NvbnRhY3Qtc2VnbWVudHMudHNcbnZhciBDb250YWN0U2VnbWVudHMgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKHJlc2VuZCkge1xuICAgIHRoaXMucmVzZW5kID0gcmVzZW5kO1xuICB9XG4gIGFzeW5jIGxpc3Qob3B0aW9ucykge1xuICAgIGlmICghb3B0aW9ucy5jb250YWN0SWQgJiYgIW9wdGlvbnMuZW1haWwpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgIGhlYWRlcnM6IG51bGwsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgbWVzc2FnZTogXCJNaXNzaW5nIGBpZGAgb3IgYGVtYWlsYCBmaWVsZC5cIixcbiAgICAgICAgICBzdGF0dXNDb2RlOiBudWxsLFxuICAgICAgICAgIG5hbWU6IFwibWlzc2luZ19yZXF1aXJlZF9maWVsZFwiXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICAgIGNvbnN0IGlkZW50aWZpZXIgPSBvcHRpb25zLmVtYWlsID8gb3B0aW9ucy5lbWFpbCA6IG9wdGlvbnMuY29udGFjdElkO1xuICAgIGNvbnN0IHF1ZXJ5U3RyaW5nID0gYnVpbGRQYWdpbmF0aW9uUXVlcnkob3B0aW9ucyk7XG4gICAgY29uc3QgdXJsID0gcXVlcnlTdHJpbmcgPyBgL2NvbnRhY3RzLyR7aWRlbnRpZmllcn0vc2VnbWVudHM/JHtxdWVyeVN0cmluZ31gIDogYC9jb250YWN0cy8ke2lkZW50aWZpZXJ9L3NlZ21lbnRzYDtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQuZ2V0KHVybCk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbiAgYXN5bmMgYWRkKG9wdGlvbnMpIHtcbiAgICBpZiAoIW9wdGlvbnMuY29udGFjdElkICYmICFvcHRpb25zLmVtYWlsKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBoZWFkZXJzOiBudWxsLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIG1lc3NhZ2U6IFwiTWlzc2luZyBgaWRgIG9yIGBlbWFpbGAgZmllbGQuXCIsXG4gICAgICAgICAgc3RhdHVzQ29kZTogbnVsbCxcbiAgICAgICAgICBuYW1lOiBcIm1pc3NpbmdfcmVxdWlyZWRfZmllbGRcIlxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgICBjb25zdCBpZGVudGlmaWVyID0gb3B0aW9ucy5lbWFpbCA/IG9wdGlvbnMuZW1haWwgOiBvcHRpb25zLmNvbnRhY3RJZDtcbiAgICByZXR1cm4gdGhpcy5yZXNlbmQucG9zdChcbiAgICAgIGAvY29udGFjdHMvJHtpZGVudGlmaWVyfS9zZWdtZW50cy8ke29wdGlvbnMuc2VnbWVudElkfWBcbiAgICApO1xuICB9XG4gIGFzeW5jIHJlbW92ZShvcHRpb25zKSB7XG4gICAgaWYgKCFvcHRpb25zLmNvbnRhY3RJZCAmJiAhb3B0aW9ucy5lbWFpbCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgaGVhZGVyczogbnVsbCxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBtZXNzYWdlOiBcIk1pc3NpbmcgYGlkYCBvciBgZW1haWxgIGZpZWxkLlwiLFxuICAgICAgICAgIHN0YXR1c0NvZGU6IG51bGwsXG4gICAgICAgICAgbmFtZTogXCJtaXNzaW5nX3JlcXVpcmVkX2ZpZWxkXCJcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gICAgY29uc3QgaWRlbnRpZmllciA9IG9wdGlvbnMuZW1haWwgPyBvcHRpb25zLmVtYWlsIDogb3B0aW9ucy5jb250YWN0SWQ7XG4gICAgcmV0dXJuIHRoaXMucmVzZW5kLmRlbGV0ZShcbiAgICAgIGAvY29udGFjdHMvJHtpZGVudGlmaWVyfS9zZWdtZW50cy8ke29wdGlvbnMuc2VnbWVudElkfWBcbiAgICApO1xuICB9XG59O1xuXG4vLyBzcmMvY29udGFjdHMvdG9waWNzL2NvbnRhY3QtdG9waWNzLnRzXG52YXIgQ29udGFjdFRvcGljcyA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IocmVzZW5kKSB7XG4gICAgdGhpcy5yZXNlbmQgPSByZXNlbmQ7XG4gIH1cbiAgYXN5bmMgdXBkYXRlKHBheWxvYWQpIHtcbiAgICBpZiAoIXBheWxvYWQuaWQgJiYgIXBheWxvYWQuZW1haWwpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgIGhlYWRlcnM6IG51bGwsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgbWVzc2FnZTogXCJNaXNzaW5nIGBpZGAgb3IgYGVtYWlsYCBmaWVsZC5cIixcbiAgICAgICAgICBzdGF0dXNDb2RlOiBudWxsLFxuICAgICAgICAgIG5hbWU6IFwibWlzc2luZ19yZXF1aXJlZF9maWVsZFwiXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICAgIGNvbnN0IGlkZW50aWZpZXIgPSBwYXlsb2FkLmVtYWlsID8gcGF5bG9hZC5lbWFpbCA6IHBheWxvYWQuaWQ7XG4gICAgcmV0dXJuIHRoaXMucmVzZW5kLnBhdGNoKFxuICAgICAgYC9jb250YWN0cy8ke2lkZW50aWZpZXJ9L3RvcGljc2AsXG4gICAgICBwYXlsb2FkLnRvcGljc1xuICAgICk7XG4gIH1cbiAgYXN5bmMgbGlzdChvcHRpb25zKSB7XG4gICAgaWYgKCFvcHRpb25zLmlkICYmICFvcHRpb25zLmVtYWlsKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBoZWFkZXJzOiBudWxsLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIG1lc3NhZ2U6IFwiTWlzc2luZyBgaWRgIG9yIGBlbWFpbGAgZmllbGQuXCIsXG4gICAgICAgICAgc3RhdHVzQ29kZTogbnVsbCxcbiAgICAgICAgICBuYW1lOiBcIm1pc3NpbmdfcmVxdWlyZWRfZmllbGRcIlxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgICBjb25zdCBpZGVudGlmaWVyID0gb3B0aW9ucy5lbWFpbCA/IG9wdGlvbnMuZW1haWwgOiBvcHRpb25zLmlkO1xuICAgIGNvbnN0IHF1ZXJ5U3RyaW5nID0gYnVpbGRQYWdpbmF0aW9uUXVlcnkob3B0aW9ucyk7XG4gICAgY29uc3QgdXJsID0gcXVlcnlTdHJpbmcgPyBgL2NvbnRhY3RzLyR7aWRlbnRpZmllcn0vdG9waWNzPyR7cXVlcnlTdHJpbmd9YCA6IGAvY29udGFjdHMvJHtpZGVudGlmaWVyfS90b3BpY3NgO1xuICAgIHJldHVybiB0aGlzLnJlc2VuZC5nZXQodXJsKTtcbiAgfVxufTtcblxuLy8gc3JjL2NvbnRhY3RzL2NvbnRhY3RzLnRzXG52YXIgQ29udGFjdHMgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKHJlc2VuZCkge1xuICAgIHRoaXMucmVzZW5kID0gcmVzZW5kO1xuICAgIHRoaXMudG9waWNzID0gbmV3IENvbnRhY3RUb3BpY3ModGhpcy5yZXNlbmQpO1xuICAgIHRoaXMuc2VnbWVudHMgPSBuZXcgQ29udGFjdFNlZ21lbnRzKHRoaXMucmVzZW5kKTtcbiAgfVxuICBhc3luYyBjcmVhdGUocGF5bG9hZCwgb3B0aW9ucyA9IHt9KSB7XG4gICAgaWYgKCFwYXlsb2FkLmF1ZGllbmNlSWQpIHtcbiAgICAgIGNvbnN0IGRhdGEyID0gYXdhaXQgdGhpcy5yZXNlbmQucG9zdChcbiAgICAgICAgXCIvY29udGFjdHNcIixcbiAgICAgICAge1xuICAgICAgICAgIHVuc3Vic2NyaWJlZDogcGF5bG9hZC51bnN1YnNjcmliZWQsXG4gICAgICAgICAgZW1haWw6IHBheWxvYWQuZW1haWwsXG4gICAgICAgICAgZmlyc3RfbmFtZTogcGF5bG9hZC5maXJzdE5hbWUsXG4gICAgICAgICAgbGFzdF9uYW1lOiBwYXlsb2FkLmxhc3ROYW1lLFxuICAgICAgICAgIHByb3BlcnRpZXM6IHBheWxvYWQucHJvcGVydGllc1xuICAgICAgICB9LFxuICAgICAgICBvcHRpb25zXG4gICAgICApO1xuICAgICAgcmV0dXJuIGRhdGEyO1xuICAgIH1cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQucG9zdChcbiAgICAgIGAvYXVkaWVuY2VzLyR7cGF5bG9hZC5hdWRpZW5jZUlkfS9jb250YWN0c2AsXG4gICAgICB7XG4gICAgICAgIHVuc3Vic2NyaWJlZDogcGF5bG9hZC51bnN1YnNjcmliZWQsXG4gICAgICAgIGVtYWlsOiBwYXlsb2FkLmVtYWlsLFxuICAgICAgICBmaXJzdF9uYW1lOiBwYXlsb2FkLmZpcnN0TmFtZSxcbiAgICAgICAgbGFzdF9uYW1lOiBwYXlsb2FkLmxhc3ROYW1lLFxuICAgICAgICBwcm9wZXJ0aWVzOiBwYXlsb2FkLnByb3BlcnRpZXNcbiAgICAgIH0sXG4gICAgICBvcHRpb25zXG4gICAgKTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuICBhc3luYyBsaXN0KG9wdGlvbnMgPSB7fSkge1xuICAgIGlmICghKFwiYXVkaWVuY2VJZFwiIGluIG9wdGlvbnMpIHx8IG9wdGlvbnMuYXVkaWVuY2VJZCA9PT0gdm9pZCAwKSB7XG4gICAgICBjb25zdCBxdWVyeVN0cmluZzIgPSBidWlsZFBhZ2luYXRpb25RdWVyeShvcHRpb25zKTtcbiAgICAgIGNvbnN0IHVybDIgPSBxdWVyeVN0cmluZzIgPyBgL2NvbnRhY3RzPyR7cXVlcnlTdHJpbmcyfWAgOiBcIi9jb250YWN0c1wiO1xuICAgICAgY29uc3QgZGF0YTIgPSBhd2FpdCB0aGlzLnJlc2VuZC5nZXQodXJsMik7XG4gICAgICByZXR1cm4gZGF0YTI7XG4gICAgfVxuICAgIGNvbnN0IF9hID0gb3B0aW9ucywgeyBhdWRpZW5jZUlkIH0gPSBfYSwgcGFnaW5hdGlvbk9wdGlvbnMgPSBfX29ialJlc3QoX2EsIFtcImF1ZGllbmNlSWRcIl0pO1xuICAgIGNvbnN0IHF1ZXJ5U3RyaW5nID0gYnVpbGRQYWdpbmF0aW9uUXVlcnkocGFnaW5hdGlvbk9wdGlvbnMpO1xuICAgIGNvbnN0IHVybCA9IHF1ZXJ5U3RyaW5nID8gYC9hdWRpZW5jZXMvJHthdWRpZW5jZUlkfS9jb250YWN0cz8ke3F1ZXJ5U3RyaW5nfWAgOiBgL2F1ZGllbmNlcy8ke2F1ZGllbmNlSWR9L2NvbnRhY3RzYDtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQuZ2V0KHVybCk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbiAgYXN5bmMgZ2V0KG9wdGlvbnMpIHtcbiAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIHJldHVybiB0aGlzLnJlc2VuZC5nZXQoYC9jb250YWN0cy8ke29wdGlvbnN9YCk7XG4gICAgfVxuICAgIGlmICghb3B0aW9ucy5pZCAmJiAhb3B0aW9ucy5lbWFpbCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgaGVhZGVyczogbnVsbCxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBtZXNzYWdlOiBcIk1pc3NpbmcgYGlkYCBvciBgZW1haWxgIGZpZWxkLlwiLFxuICAgICAgICAgIHN0YXR1c0NvZGU6IG51bGwsXG4gICAgICAgICAgbmFtZTogXCJtaXNzaW5nX3JlcXVpcmVkX2ZpZWxkXCJcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKCFvcHRpb25zLmF1ZGllbmNlSWQpIHtcbiAgICAgIHJldHVybiB0aGlzLnJlc2VuZC5nZXQoXG4gICAgICAgIGAvY29udGFjdHMvJHsob3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5lbWFpbCkgPyBvcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBvcHRpb25zLmVtYWlsIDogb3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5pZH1gXG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5yZXNlbmQuZ2V0KFxuICAgICAgYC9hdWRpZW5jZXMvJHtvcHRpb25zLmF1ZGllbmNlSWR9L2NvbnRhY3RzLyR7KG9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IG9wdGlvbnMuZW1haWwpID8gb3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5lbWFpbCA6IG9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IG9wdGlvbnMuaWR9YFxuICAgICk7XG4gIH1cbiAgYXN5bmMgdXBkYXRlKG9wdGlvbnMpIHtcbiAgICBpZiAoIW9wdGlvbnMuaWQgJiYgIW9wdGlvbnMuZW1haWwpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgIGhlYWRlcnM6IG51bGwsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgbWVzc2FnZTogXCJNaXNzaW5nIGBpZGAgb3IgYGVtYWlsYCBmaWVsZC5cIixcbiAgICAgICAgICBzdGF0dXNDb2RlOiBudWxsLFxuICAgICAgICAgIG5hbWU6IFwibWlzc2luZ19yZXF1aXJlZF9maWVsZFwiXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICAgIGlmICghb3B0aW9ucy5hdWRpZW5jZUlkKSB7XG4gICAgICBjb25zdCBkYXRhMiA9IGF3YWl0IHRoaXMucmVzZW5kLnBhdGNoKFxuICAgICAgICBgL2NvbnRhY3RzLyR7KG9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IG9wdGlvbnMuZW1haWwpID8gb3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5lbWFpbCA6IG9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IG9wdGlvbnMuaWR9YCxcbiAgICAgICAge1xuICAgICAgICAgIHVuc3Vic2NyaWJlZDogb3B0aW9ucy51bnN1YnNjcmliZWQsXG4gICAgICAgICAgZmlyc3RfbmFtZTogb3B0aW9ucy5maXJzdE5hbWUsXG4gICAgICAgICAgbGFzdF9uYW1lOiBvcHRpb25zLmxhc3ROYW1lLFxuICAgICAgICAgIHByb3BlcnRpZXM6IG9wdGlvbnMucHJvcGVydGllc1xuICAgICAgICB9XG4gICAgICApO1xuICAgICAgcmV0dXJuIGRhdGEyO1xuICAgIH1cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQucGF0Y2goXG4gICAgICBgL2F1ZGllbmNlcy8ke29wdGlvbnMuYXVkaWVuY2VJZH0vY29udGFjdHMvJHsob3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5lbWFpbCkgPyBvcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBvcHRpb25zLmVtYWlsIDogb3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5pZH1gLFxuICAgICAge1xuICAgICAgICB1bnN1YnNjcmliZWQ6IG9wdGlvbnMudW5zdWJzY3JpYmVkLFxuICAgICAgICBmaXJzdF9uYW1lOiBvcHRpb25zLmZpcnN0TmFtZSxcbiAgICAgICAgbGFzdF9uYW1lOiBvcHRpb25zLmxhc3ROYW1lLFxuICAgICAgICBwcm9wZXJ0aWVzOiBvcHRpb25zLnByb3BlcnRpZXNcbiAgICAgIH1cbiAgICApO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG4gIGFzeW5jIHJlbW92ZShwYXlsb2FkKSB7XG4gICAgaWYgKHR5cGVvZiBwYXlsb2FkID09PSBcInN0cmluZ1wiKSB7XG4gICAgICByZXR1cm4gdGhpcy5yZXNlbmQuZGVsZXRlKFxuICAgICAgICBgL2NvbnRhY3RzLyR7cGF5bG9hZH1gXG4gICAgICApO1xuICAgIH1cbiAgICBpZiAoIXBheWxvYWQuaWQgJiYgIXBheWxvYWQuZW1haWwpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgIGhlYWRlcnM6IG51bGwsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgbWVzc2FnZTogXCJNaXNzaW5nIGBpZGAgb3IgYGVtYWlsYCBmaWVsZC5cIixcbiAgICAgICAgICBzdGF0dXNDb2RlOiBudWxsLFxuICAgICAgICAgIG5hbWU6IFwibWlzc2luZ19yZXF1aXJlZF9maWVsZFwiXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICAgIGlmICghcGF5bG9hZC5hdWRpZW5jZUlkKSB7XG4gICAgICByZXR1cm4gdGhpcy5yZXNlbmQuZGVsZXRlKFxuICAgICAgICBgL2NvbnRhY3RzLyR7KHBheWxvYWQgPT0gbnVsbCA/IHZvaWQgMCA6IHBheWxvYWQuZW1haWwpID8gcGF5bG9hZCA9PSBudWxsID8gdm9pZCAwIDogcGF5bG9hZC5lbWFpbCA6IHBheWxvYWQgPT0gbnVsbCA/IHZvaWQgMCA6IHBheWxvYWQuaWR9YFxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMucmVzZW5kLmRlbGV0ZShcbiAgICAgIGAvYXVkaWVuY2VzLyR7cGF5bG9hZC5hdWRpZW5jZUlkfS9jb250YWN0cy8keyhwYXlsb2FkID09IG51bGwgPyB2b2lkIDAgOiBwYXlsb2FkLmVtYWlsKSA/IHBheWxvYWQgPT0gbnVsbCA/IHZvaWQgMCA6IHBheWxvYWQuZW1haWwgOiBwYXlsb2FkID09IG51bGwgPyB2b2lkIDAgOiBwYXlsb2FkLmlkfWBcbiAgICApO1xuICB9XG59O1xuXG4vLyBzcmMvY29tbW9uL3V0aWxzL3BhcnNlLWRvbWFpbi10by1hcGktb3B0aW9ucy50c1xuZnVuY3Rpb24gcGFyc2VEb21haW5Ub0FwaU9wdGlvbnMoZG9tYWluKSB7XG4gIHJldHVybiB7XG4gICAgbmFtZTogZG9tYWluLm5hbWUsXG4gICAgcmVnaW9uOiBkb21haW4ucmVnaW9uLFxuICAgIGN1c3RvbV9yZXR1cm5fcGF0aDogZG9tYWluLmN1c3RvbVJldHVyblBhdGhcbiAgfTtcbn1cblxuLy8gc3JjL2RvbWFpbnMvZG9tYWlucy50c1xudmFyIERvbWFpbnMgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKHJlc2VuZCkge1xuICAgIHRoaXMucmVzZW5kID0gcmVzZW5kO1xuICB9XG4gIGFzeW5jIGNyZWF0ZShwYXlsb2FkLCBvcHRpb25zID0ge30pIHtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQucG9zdChcbiAgICAgIFwiL2RvbWFpbnNcIixcbiAgICAgIHBhcnNlRG9tYWluVG9BcGlPcHRpb25zKHBheWxvYWQpLFxuICAgICAgb3B0aW9uc1xuICAgICk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbiAgYXN5bmMgbGlzdChvcHRpb25zID0ge30pIHtcbiAgICBjb25zdCBxdWVyeVN0cmluZyA9IGJ1aWxkUGFnaW5hdGlvblF1ZXJ5KG9wdGlvbnMpO1xuICAgIGNvbnN0IHVybCA9IHF1ZXJ5U3RyaW5nID8gYC9kb21haW5zPyR7cXVlcnlTdHJpbmd9YCA6IFwiL2RvbWFpbnNcIjtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQuZ2V0KHVybCk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbiAgYXN5bmMgZ2V0KGlkKSB7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMucmVzZW5kLmdldChcbiAgICAgIGAvZG9tYWlucy8ke2lkfWBcbiAgICApO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG4gIGFzeW5jIHVwZGF0ZShwYXlsb2FkKSB7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMucmVzZW5kLnBhdGNoKFxuICAgICAgYC9kb21haW5zLyR7cGF5bG9hZC5pZH1gLFxuICAgICAge1xuICAgICAgICBjbGlja190cmFja2luZzogcGF5bG9hZC5jbGlja1RyYWNraW5nLFxuICAgICAgICBvcGVuX3RyYWNraW5nOiBwYXlsb2FkLm9wZW5UcmFja2luZyxcbiAgICAgICAgdGxzOiBwYXlsb2FkLnRsc1xuICAgICAgfVxuICAgICk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbiAgYXN5bmMgcmVtb3ZlKGlkKSB7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMucmVzZW5kLmRlbGV0ZShcbiAgICAgIGAvZG9tYWlucy8ke2lkfWBcbiAgICApO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG4gIGFzeW5jIHZlcmlmeShpZCkge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLnJlc2VuZC5wb3N0KFxuICAgICAgYC9kb21haW5zLyR7aWR9L3ZlcmlmeWBcbiAgICApO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG59O1xuXG4vLyBzcmMvZW1haWxzL2F0dGFjaG1lbnRzL2F0dGFjaG1lbnRzLnRzXG52YXIgQXR0YWNobWVudHMgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKHJlc2VuZCkge1xuICAgIHRoaXMucmVzZW5kID0gcmVzZW5kO1xuICB9XG4gIGFzeW5jIGdldChvcHRpb25zKSB7XG4gICAgY29uc3QgeyBlbWFpbElkLCBpZCB9ID0gb3B0aW9ucztcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQuZ2V0KFxuICAgICAgYC9lbWFpbHMvJHtlbWFpbElkfS9hdHRhY2htZW50cy8ke2lkfWBcbiAgICApO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG4gIGFzeW5jIGxpc3Qob3B0aW9ucykge1xuICAgIGNvbnN0IHsgZW1haWxJZCB9ID0gb3B0aW9ucztcbiAgICBjb25zdCBxdWVyeVN0cmluZyA9IGJ1aWxkUGFnaW5hdGlvblF1ZXJ5KG9wdGlvbnMpO1xuICAgIGNvbnN0IHVybCA9IHF1ZXJ5U3RyaW5nID8gYC9lbWFpbHMvJHtlbWFpbElkfS9hdHRhY2htZW50cz8ke3F1ZXJ5U3RyaW5nfWAgOiBgL2VtYWlscy8ke2VtYWlsSWR9L2F0dGFjaG1lbnRzYDtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQuZ2V0KHVybCk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbn07XG5cbi8vIHNyYy9lbWFpbHMvcmVjZWl2aW5nL2F0dGFjaG1lbnRzL2F0dGFjaG1lbnRzLnRzXG52YXIgQXR0YWNobWVudHMyID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcihyZXNlbmQpIHtcbiAgICB0aGlzLnJlc2VuZCA9IHJlc2VuZDtcbiAgfVxuICBhc3luYyBnZXQob3B0aW9ucykge1xuICAgIGNvbnN0IHsgZW1haWxJZCwgaWQgfSA9IG9wdGlvbnM7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMucmVzZW5kLmdldChcbiAgICAgIGAvZW1haWxzL3JlY2VpdmluZy8ke2VtYWlsSWR9L2F0dGFjaG1lbnRzLyR7aWR9YFxuICAgICk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbiAgYXN5bmMgbGlzdChvcHRpb25zKSB7XG4gICAgY29uc3QgeyBlbWFpbElkIH0gPSBvcHRpb25zO1xuICAgIGNvbnN0IHF1ZXJ5U3RyaW5nID0gYnVpbGRQYWdpbmF0aW9uUXVlcnkob3B0aW9ucyk7XG4gICAgY29uc3QgdXJsID0gcXVlcnlTdHJpbmcgPyBgL2VtYWlscy9yZWNlaXZpbmcvJHtlbWFpbElkfS9hdHRhY2htZW50cz8ke3F1ZXJ5U3RyaW5nfWAgOiBgL2VtYWlscy9yZWNlaXZpbmcvJHtlbWFpbElkfS9hdHRhY2htZW50c2A7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMucmVzZW5kLmdldCh1cmwpO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG59O1xuXG4vLyBzcmMvZW1haWxzL3JlY2VpdmluZy9yZWNlaXZpbmcudHNcbnZhciBSZWNlaXZpbmcgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKHJlc2VuZCkge1xuICAgIHRoaXMucmVzZW5kID0gcmVzZW5kO1xuICAgIHRoaXMuYXR0YWNobWVudHMgPSBuZXcgQXR0YWNobWVudHMyKHJlc2VuZCk7XG4gIH1cbiAgYXN5bmMgZ2V0KGlkKSB7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMucmVzZW5kLmdldChcbiAgICAgIGAvZW1haWxzL3JlY2VpdmluZy8ke2lkfWBcbiAgICApO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG4gIGFzeW5jIGxpc3Qob3B0aW9ucyA9IHt9KSB7XG4gICAgY29uc3QgcXVlcnlTdHJpbmcgPSBidWlsZFBhZ2luYXRpb25RdWVyeShvcHRpb25zKTtcbiAgICBjb25zdCB1cmwgPSBxdWVyeVN0cmluZyA/IGAvZW1haWxzL3JlY2VpdmluZz8ke3F1ZXJ5U3RyaW5nfWAgOiBcIi9lbWFpbHMvcmVjZWl2aW5nXCI7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMucmVzZW5kLmdldCh1cmwpO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG59O1xuXG4vLyBzcmMvZW1haWxzL2VtYWlscy50c1xudmFyIEVtYWlscyA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IocmVzZW5kKSB7XG4gICAgdGhpcy5yZXNlbmQgPSByZXNlbmQ7XG4gICAgdGhpcy5hdHRhY2htZW50cyA9IG5ldyBBdHRhY2htZW50cyhyZXNlbmQpO1xuICAgIHRoaXMucmVjZWl2aW5nID0gbmV3IFJlY2VpdmluZyhyZXNlbmQpO1xuICB9XG4gIGFzeW5jIHNlbmQocGF5bG9hZCwgb3B0aW9ucyA9IHt9KSB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlKHBheWxvYWQsIG9wdGlvbnMpO1xuICB9XG4gIGFzeW5jIGNyZWF0ZShwYXlsb2FkLCBvcHRpb25zID0ge30pIHtcbiAgICBpZiAocGF5bG9hZC5yZWFjdCkge1xuICAgICAgcGF5bG9hZC5odG1sID0gYXdhaXQgcmVuZGVyKHBheWxvYWQucmVhY3QpO1xuICAgIH1cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQucG9zdChcbiAgICAgIFwiL2VtYWlsc1wiLFxuICAgICAgcGFyc2VFbWFpbFRvQXBpT3B0aW9ucyhwYXlsb2FkKSxcbiAgICAgIG9wdGlvbnNcbiAgICApO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG4gIGFzeW5jIGdldChpZCkge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLnJlc2VuZC5nZXQoXG4gICAgICBgL2VtYWlscy8ke2lkfWBcbiAgICApO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG4gIGFzeW5jIGxpc3Qob3B0aW9ucyA9IHt9KSB7XG4gICAgY29uc3QgcXVlcnlTdHJpbmcgPSBidWlsZFBhZ2luYXRpb25RdWVyeShvcHRpb25zKTtcbiAgICBjb25zdCB1cmwgPSBxdWVyeVN0cmluZyA/IGAvZW1haWxzPyR7cXVlcnlTdHJpbmd9YCA6IFwiL2VtYWlsc1wiO1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLnJlc2VuZC5nZXQodXJsKTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuICBhc3luYyB1cGRhdGUocGF5bG9hZCkge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLnJlc2VuZC5wYXRjaChcbiAgICAgIGAvZW1haWxzLyR7cGF5bG9hZC5pZH1gLFxuICAgICAge1xuICAgICAgICBzY2hlZHVsZWRfYXQ6IHBheWxvYWQuc2NoZWR1bGVkQXRcbiAgICAgIH1cbiAgICApO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG4gIGFzeW5jIGNhbmNlbChpZCkge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLnJlc2VuZC5wb3N0KFxuICAgICAgYC9lbWFpbHMvJHtpZH0vY2FuY2VsYFxuICAgICk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbn07XG5cbi8vIHNyYy9zZWdtZW50cy9zZWdtZW50cy50c1xudmFyIFNlZ21lbnRzID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcihyZXNlbmQpIHtcbiAgICB0aGlzLnJlc2VuZCA9IHJlc2VuZDtcbiAgfVxuICBhc3luYyBjcmVhdGUocGF5bG9hZCwgb3B0aW9ucyA9IHt9KSB7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMucmVzZW5kLnBvc3QoXG4gICAgICBcIi9zZWdtZW50c1wiLFxuICAgICAgcGF5bG9hZCxcbiAgICAgIG9wdGlvbnNcbiAgICApO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG4gIGFzeW5jIGxpc3Qob3B0aW9ucyA9IHt9KSB7XG4gICAgY29uc3QgcXVlcnlTdHJpbmcgPSBidWlsZFBhZ2luYXRpb25RdWVyeShvcHRpb25zKTtcbiAgICBjb25zdCB1cmwgPSBxdWVyeVN0cmluZyA/IGAvc2VnbWVudHM/JHtxdWVyeVN0cmluZ31gIDogXCIvc2VnbWVudHNcIjtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQuZ2V0KHVybCk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbiAgYXN5bmMgZ2V0KGlkKSB7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMucmVzZW5kLmdldChcbiAgICAgIGAvc2VnbWVudHMvJHtpZH1gXG4gICAgKTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuICBhc3luYyByZW1vdmUoaWQpIHtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQuZGVsZXRlKFxuICAgICAgYC9zZWdtZW50cy8ke2lkfWBcbiAgICApO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG59O1xuXG4vLyBzcmMvY29tbW9uL3V0aWxzL2dldC1wYWdpbmF0aW9uLXF1ZXJ5LXByb3BlcnRpZXMudHNcbmZ1bmN0aW9uIGdldFBhZ2luYXRpb25RdWVyeVByb3BlcnRpZXMob3B0aW9ucyA9IHt9KSB7XG4gIGNvbnN0IHF1ZXJ5ID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuICBpZiAob3B0aW9ucy5iZWZvcmUpIHF1ZXJ5LnNldChcImJlZm9yZVwiLCBvcHRpb25zLmJlZm9yZSk7XG4gIGlmIChvcHRpb25zLmFmdGVyKSBxdWVyeS5zZXQoXCJhZnRlclwiLCBvcHRpb25zLmFmdGVyKTtcbiAgaWYgKG9wdGlvbnMubGltaXQpIHF1ZXJ5LnNldChcImxpbWl0XCIsIG9wdGlvbnMubGltaXQudG9TdHJpbmcoKSk7XG4gIHJldHVybiBxdWVyeS5zaXplID4gMCA/IGA/JHtxdWVyeS50b1N0cmluZygpfWAgOiBcIlwiO1xufVxuXG4vLyBzcmMvY29tbW9uL3V0aWxzL3BhcnNlLXRlbXBsYXRlLXRvLWFwaS1vcHRpb25zLnRzXG5mdW5jdGlvbiBwYXJzZVZhcmlhYmxlcyh2YXJpYWJsZXMpIHtcbiAgcmV0dXJuIHZhcmlhYmxlcyA9PSBudWxsID8gdm9pZCAwIDogdmFyaWFibGVzLm1hcCgodmFyaWFibGUpID0+ICh7XG4gICAga2V5OiB2YXJpYWJsZS5rZXksXG4gICAgdHlwZTogdmFyaWFibGUudHlwZSxcbiAgICBmYWxsYmFja192YWx1ZTogdmFyaWFibGUuZmFsbGJhY2tWYWx1ZVxuICB9KSk7XG59XG5mdW5jdGlvbiBwYXJzZVRlbXBsYXRlVG9BcGlPcHRpb25zKHRlbXBsYXRlKSB7XG4gIHJldHVybiB7XG4gICAgbmFtZTogXCJuYW1lXCIgaW4gdGVtcGxhdGUgPyB0ZW1wbGF0ZS5uYW1lIDogdm9pZCAwLFxuICAgIHN1YmplY3Q6IHRlbXBsYXRlLnN1YmplY3QsXG4gICAgaHRtbDogdGVtcGxhdGUuaHRtbCxcbiAgICB0ZXh0OiB0ZW1wbGF0ZS50ZXh0LFxuICAgIGFsaWFzOiB0ZW1wbGF0ZS5hbGlhcyxcbiAgICBmcm9tOiB0ZW1wbGF0ZS5mcm9tLFxuICAgIHJlcGx5X3RvOiB0ZW1wbGF0ZS5yZXBseVRvLFxuICAgIHZhcmlhYmxlczogcGFyc2VWYXJpYWJsZXModGVtcGxhdGUudmFyaWFibGVzKVxuICB9O1xufVxuXG4vLyBzcmMvdGVtcGxhdGVzL2NoYWluYWJsZS10ZW1wbGF0ZS1yZXN1bHQudHNcbnZhciBDaGFpbmFibGVUZW1wbGF0ZVJlc3VsdCA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IocHJvbWlzZSwgcHVibGlzaEZuKSB7XG4gICAgdGhpcy5wcm9taXNlID0gcHJvbWlzZTtcbiAgICB0aGlzLnB1Ymxpc2hGbiA9IHB1Ymxpc2hGbjtcbiAgfVxuICAvLyBJZiB1c2VyIGNhbGxzIGB0aGVuYCBvciBvbmx5IGF3YWl0cyBmb3IgdGhlIHJlc3VsdCBvZiBjcmVhdGUoKSBvciBkdXBsaWNhdGUoKSwgdGhlIGJlaGF2aW9yIHNob3VsZCBiZVxuICAvLyBleGFjdGx5IGFzIGlmIHRoZXkgY2FsbGVkIGNyZWF0ZSgpIG9yIGR1cGxpY2F0ZSgpIGRpcmVjdGx5LiBUaGlzIHdpbGwgYWN0IGFzIGEgbm9ybWFsIHByb21pc2VcbiAgLy8gYmlvbWUtaWdub3JlIGxpbnQvc3VzcGljaW91cy9ub1RoZW5Qcm9wZXJ0eTogVGhpcyBjbGFzcyBpbnRlbnRpb25hbGx5IGltcGxlbWVudHMgUHJvbWlzZUxpa2VcbiAgdGhlbihvbmZ1bGZpbGxlZCwgb25yZWplY3RlZCkge1xuICAgIHJldHVybiB0aGlzLnByb21pc2UudGhlbihvbmZ1bGZpbGxlZCwgb25yZWplY3RlZCk7XG4gIH1cbiAgYXN5bmMgcHVibGlzaCgpIHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnByb21pc2U7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBoZWFkZXJzOiBudWxsLFxuICAgICAgICBlcnJvclxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMucHVibGlzaEZuKGRhdGEuaWQpO1xuICB9XG59O1xuXG4vLyBzcmMvdGVtcGxhdGVzL3RlbXBsYXRlcy50c1xudmFyIFRlbXBsYXRlcyA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IocmVzZW5kKSB7XG4gICAgdGhpcy5yZXNlbmQgPSByZXNlbmQ7XG4gIH1cbiAgY3JlYXRlKHBheWxvYWQpIHtcbiAgICBjb25zdCBjcmVhdGVQcm9taXNlID0gdGhpcy5wZXJmb3JtQ3JlYXRlKHBheWxvYWQpO1xuICAgIHJldHVybiBuZXcgQ2hhaW5hYmxlVGVtcGxhdGVSZXN1bHQoY3JlYXRlUHJvbWlzZSwgdGhpcy5wdWJsaXNoLmJpbmQodGhpcykpO1xuICB9XG4gIC8vIFRoaXMgY3JlYXRpb24gcHJvY2VzcyBpcyBiZWluZyBkb25lIHNlcGFyYXRlbHkgZnJvbSB0aGUgcHVibGljIGNyZWF0ZSBzbyB0aGF0XG4gIC8vIHRoZSB1c2VyIGNhbiBjaGFpbiB0aGUgcHVibGlzaCBvcGVyYXRpb24gYWZ0ZXIgdGhlIGNyZWF0ZSBvcGVyYXRpb24uIE90aGVyd2lzZSwgZHVlXG4gIC8vIHRvIHRoZSBhc3luYyBuYXR1cmUgb2YgdGhlIHJlbmRlckFzeW5jLCB0aGUgcmV0dXJuIHR5cGUgd291bGQgYmVcbiAgLy8gUHJvbWlzZTxDaGFpbmFibGVUZW1wbGF0ZVJlc3VsdDxDcmVhdGVUZW1wbGF0ZVJlc3BvbnNlPj4gd2hpY2ggd291bGRuJ3QgYmUgY2hhaW5hYmxlLlxuICBhc3luYyBwZXJmb3JtQ3JlYXRlKHBheWxvYWQpIHtcbiAgICBpZiAocGF5bG9hZC5yZWFjdCkge1xuICAgICAgaWYgKCF0aGlzLnJlbmRlckFzeW5jKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgeyByZW5kZXJBc3luYyB9ID0gYXdhaXQgaW1wb3J0KFwiQHJlYWN0LWVtYWlsL3JlbmRlclwiKTtcbiAgICAgICAgICB0aGlzLnJlbmRlckFzeW5jID0gcmVuZGVyQXN5bmM7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICBcIkZhaWxlZCB0byByZW5kZXIgUmVhY3QgY29tcG9uZW50LiBNYWtlIHN1cmUgdG8gaW5zdGFsbCBgQHJlYWN0LWVtYWlsL3JlbmRlcmBcIlxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHBheWxvYWQuaHRtbCA9IGF3YWl0IHRoaXMucmVuZGVyQXN5bmMoXG4gICAgICAgIHBheWxvYWQucmVhY3RcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnJlc2VuZC5wb3N0KFxuICAgICAgXCIvdGVtcGxhdGVzXCIsXG4gICAgICBwYXJzZVRlbXBsYXRlVG9BcGlPcHRpb25zKHBheWxvYWQpXG4gICAgKTtcbiAgfVxuICBhc3luYyByZW1vdmUoaWRlbnRpZmllcikge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLnJlc2VuZC5kZWxldGUoXG4gICAgICBgL3RlbXBsYXRlcy8ke2lkZW50aWZpZXJ9YFxuICAgICk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbiAgYXN5bmMgZ2V0KGlkZW50aWZpZXIpIHtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQuZ2V0KFxuICAgICAgYC90ZW1wbGF0ZXMvJHtpZGVudGlmaWVyfWBcbiAgICApO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG4gIGFzeW5jIGxpc3Qob3B0aW9ucyA9IHt9KSB7XG4gICAgcmV0dXJuIHRoaXMucmVzZW5kLmdldChcbiAgICAgIGAvdGVtcGxhdGVzJHtnZXRQYWdpbmF0aW9uUXVlcnlQcm9wZXJ0aWVzKG9wdGlvbnMpfWBcbiAgICApO1xuICB9XG4gIGR1cGxpY2F0ZShpZGVudGlmaWVyKSB7XG4gICAgY29uc3QgcHJvbWlzZUR1cGxpY2F0ZSA9IHRoaXMucmVzZW5kLnBvc3QoXG4gICAgICBgL3RlbXBsYXRlcy8ke2lkZW50aWZpZXJ9L2R1cGxpY2F0ZWBcbiAgICApO1xuICAgIHJldHVybiBuZXcgQ2hhaW5hYmxlVGVtcGxhdGVSZXN1bHQoXG4gICAgICBwcm9taXNlRHVwbGljYXRlLFxuICAgICAgdGhpcy5wdWJsaXNoLmJpbmQodGhpcylcbiAgICApO1xuICB9XG4gIGFzeW5jIHB1Ymxpc2goaWRlbnRpZmllcikge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLnJlc2VuZC5wb3N0KFxuICAgICAgYC90ZW1wbGF0ZXMvJHtpZGVudGlmaWVyfS9wdWJsaXNoYFxuICAgICk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbiAgYXN5bmMgdXBkYXRlKGlkZW50aWZpZXIsIHBheWxvYWQpIHtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQucGF0Y2goXG4gICAgICBgL3RlbXBsYXRlcy8ke2lkZW50aWZpZXJ9YCxcbiAgICAgIHBhcnNlVGVtcGxhdGVUb0FwaU9wdGlvbnMocGF5bG9hZClcbiAgICApO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG59O1xuXG4vLyBzcmMvdG9waWNzL3RvcGljcy50c1xudmFyIFRvcGljcyA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IocmVzZW5kKSB7XG4gICAgdGhpcy5yZXNlbmQgPSByZXNlbmQ7XG4gIH1cbiAgYXN5bmMgY3JlYXRlKHBheWxvYWQpIHtcbiAgICBjb25zdCBfYSA9IHBheWxvYWQsIHsgZGVmYXVsdFN1YnNjcmlwdGlvbiB9ID0gX2EsIGJvZHkgPSBfX29ialJlc3QoX2EsIFtcImRlZmF1bHRTdWJzY3JpcHRpb25cIl0pO1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLnJlc2VuZC5wb3N0KFwiL3RvcGljc1wiLCBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBib2R5KSwge1xuICAgICAgZGVmYXVsdF9zdWJzY3JpcHRpb246IGRlZmF1bHRTdWJzY3JpcHRpb25cbiAgICB9KSk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbiAgYXN5bmMgbGlzdCgpIHtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQuZ2V0KFwiL3RvcGljc1wiKTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuICBhc3luYyBnZXQoaWQpIHtcbiAgICBpZiAoIWlkKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBoZWFkZXJzOiBudWxsLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIG1lc3NhZ2U6IFwiTWlzc2luZyBgaWRgIGZpZWxkLlwiLFxuICAgICAgICAgIHN0YXR1c0NvZGU6IG51bGwsXG4gICAgICAgICAgbmFtZTogXCJtaXNzaW5nX3JlcXVpcmVkX2ZpZWxkXCJcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMucmVzZW5kLmdldChcbiAgICAgIGAvdG9waWNzLyR7aWR9YFxuICAgICk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbiAgYXN5bmMgdXBkYXRlKHBheWxvYWQpIHtcbiAgICBpZiAoIXBheWxvYWQuaWQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgIGhlYWRlcnM6IG51bGwsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgbWVzc2FnZTogXCJNaXNzaW5nIGBpZGAgZmllbGQuXCIsXG4gICAgICAgICAgc3RhdHVzQ29kZTogbnVsbCxcbiAgICAgICAgICBuYW1lOiBcIm1pc3NpbmdfcmVxdWlyZWRfZmllbGRcIlxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQucGF0Y2goXG4gICAgICBgL3RvcGljcy8ke3BheWxvYWQuaWR9YCxcbiAgICAgIHBheWxvYWRcbiAgICApO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG4gIGFzeW5jIHJlbW92ZShpZCkge1xuICAgIGlmICghaWQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgIGhlYWRlcnM6IG51bGwsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgbWVzc2FnZTogXCJNaXNzaW5nIGBpZGAgZmllbGQuXCIsXG4gICAgICAgICAgc3RhdHVzQ29kZTogbnVsbCxcbiAgICAgICAgICBuYW1lOiBcIm1pc3NpbmdfcmVxdWlyZWRfZmllbGRcIlxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQuZGVsZXRlKFxuICAgICAgYC90b3BpY3MvJHtpZH1gXG4gICAgKTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxufTtcblxuLy8gc3JjL3dlYmhvb2tzL3dlYmhvb2tzLnRzXG5pbXBvcnQgeyBXZWJob29rIH0gZnJvbSBcInN2aXhcIjtcbnZhciBXZWJob29rcyA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IocmVzZW5kKSB7XG4gICAgdGhpcy5yZXNlbmQgPSByZXNlbmQ7XG4gIH1cbiAgYXN5bmMgY3JlYXRlKHBheWxvYWQsIG9wdGlvbnMgPSB7fSkge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLnJlc2VuZC5wb3N0KFxuICAgICAgXCIvd2ViaG9va3NcIixcbiAgICAgIHBheWxvYWQsXG4gICAgICBvcHRpb25zXG4gICAgKTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuICBhc3luYyBnZXQoaWQpIHtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQuZ2V0KFxuICAgICAgYC93ZWJob29rcy8ke2lkfWBcbiAgICApO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG4gIGFzeW5jIGxpc3Qob3B0aW9ucyA9IHt9KSB7XG4gICAgY29uc3QgcXVlcnlTdHJpbmcgPSBidWlsZFBhZ2luYXRpb25RdWVyeShvcHRpb25zKTtcbiAgICBjb25zdCB1cmwgPSBxdWVyeVN0cmluZyA/IGAvd2ViaG9va3M/JHtxdWVyeVN0cmluZ31gIDogXCIvd2ViaG9va3NcIjtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQuZ2V0KHVybCk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbiAgYXN5bmMgdXBkYXRlKGlkLCBwYXlsb2FkKSB7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMucmVzZW5kLnBhdGNoKFxuICAgICAgYC93ZWJob29rcy8ke2lkfWAsXG4gICAgICBwYXlsb2FkXG4gICAgKTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuICBhc3luYyByZW1vdmUoaWQpIHtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZXNlbmQuZGVsZXRlKFxuICAgICAgYC93ZWJob29rcy8ke2lkfWBcbiAgICApO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG4gIHZlcmlmeShwYXlsb2FkKSB7XG4gICAgY29uc3Qgd2ViaG9vayA9IG5ldyBXZWJob29rKHBheWxvYWQud2ViaG9va1NlY3JldCk7XG4gICAgcmV0dXJuIHdlYmhvb2sudmVyaWZ5KHBheWxvYWQucGF5bG9hZCwge1xuICAgICAgXCJzdml4LWlkXCI6IHBheWxvYWQuaGVhZGVycy5pZCxcbiAgICAgIFwic3ZpeC10aW1lc3RhbXBcIjogcGF5bG9hZC5oZWFkZXJzLnRpbWVzdGFtcCxcbiAgICAgIFwic3ZpeC1zaWduYXR1cmVcIjogcGF5bG9hZC5oZWFkZXJzLnNpZ25hdHVyZVxuICAgIH0pO1xuICB9XG59O1xuXG4vLyBzcmMvcmVzZW5kLnRzXG52YXIgZGVmYXVsdEJhc2VVcmwgPSBcImh0dHBzOi8vYXBpLnJlc2VuZC5jb21cIjtcbnZhciBkZWZhdWx0VXNlckFnZW50ID0gYHJlc2VuZC1ub2RlOiR7dmVyc2lvbn1gO1xudmFyIGJhc2VVcmwgPSB0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzLmVudiA/IHByb2Nlc3MuZW52LlJFU0VORF9CQVNFX1VSTCB8fCBkZWZhdWx0QmFzZVVybCA6IGRlZmF1bHRCYXNlVXJsO1xudmFyIHVzZXJBZ2VudCA9IHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MuZW52ID8gcHJvY2Vzcy5lbnYuUkVTRU5EX1VTRVJfQUdFTlQgfHwgZGVmYXVsdFVzZXJBZ2VudCA6IGRlZmF1bHRVc2VyQWdlbnQ7XG52YXIgUmVzZW5kID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcihrZXkpIHtcbiAgICB0aGlzLmtleSA9IGtleTtcbiAgICB0aGlzLmFwaUtleXMgPSBuZXcgQXBpS2V5cyh0aGlzKTtcbiAgICB0aGlzLnNlZ21lbnRzID0gbmV3IFNlZ21lbnRzKHRoaXMpO1xuICAgIC8qKlxuICAgICAqIEBkZXByZWNhdGVkIFVzZSBzZWdtZW50cyBpbnN0ZWFkXG4gICAgICovXG4gICAgdGhpcy5hdWRpZW5jZXMgPSB0aGlzLnNlZ21lbnRzO1xuICAgIHRoaXMuYmF0Y2ggPSBuZXcgQmF0Y2godGhpcyk7XG4gICAgdGhpcy5icm9hZGNhc3RzID0gbmV3IEJyb2FkY2FzdHModGhpcyk7XG4gICAgdGhpcy5jb250YWN0cyA9IG5ldyBDb250YWN0cyh0aGlzKTtcbiAgICB0aGlzLmNvbnRhY3RQcm9wZXJ0aWVzID0gbmV3IENvbnRhY3RQcm9wZXJ0aWVzKHRoaXMpO1xuICAgIHRoaXMuZG9tYWlucyA9IG5ldyBEb21haW5zKHRoaXMpO1xuICAgIHRoaXMuZW1haWxzID0gbmV3IEVtYWlscyh0aGlzKTtcbiAgICB0aGlzLndlYmhvb2tzID0gbmV3IFdlYmhvb2tzKHRoaXMpO1xuICAgIHRoaXMudGVtcGxhdGVzID0gbmV3IFRlbXBsYXRlcyh0aGlzKTtcbiAgICB0aGlzLnRvcGljcyA9IG5ldyBUb3BpY3ModGhpcyk7XG4gICAgaWYgKCFrZXkpIHtcbiAgICAgIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzLmVudikge1xuICAgICAgICB0aGlzLmtleSA9IHByb2Nlc3MuZW52LlJFU0VORF9BUElfS0VZO1xuICAgICAgfVxuICAgICAgaWYgKCF0aGlzLmtleSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgJ01pc3NpbmcgQVBJIGtleS4gUGFzcyBpdCB0byB0aGUgY29uc3RydWN0b3IgYG5ldyBSZXNlbmQoXCJyZV8xMjNcIilgJ1xuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLmhlYWRlcnMgPSBuZXcgSGVhZGVycyh7XG4gICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5rZXl9YCxcbiAgICAgIFwiVXNlci1BZ2VudFwiOiB1c2VyQWdlbnQsXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgIH0pO1xuICB9XG4gIGFzeW5jIGZldGNoUmVxdWVzdChwYXRoLCBvcHRpb25zID0ge30pIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfSR7cGF0aH1gLCBvcHRpb25zKTtcbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCByYXdFcnJvciA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICAgIGVycm9yOiBKU09OLnBhcnNlKHJhd0Vycm9yKSxcbiAgICAgICAgICAgIGhlYWRlcnM6IE9iamVjdC5mcm9tRW50cmllcyhyZXNwb25zZS5oZWFkZXJzLmVudHJpZXMoKSlcbiAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICBpZiAoZXJyIGluc3RhbmNlb2YgU3ludGF4RXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICAgICAgbmFtZTogXCJhcHBsaWNhdGlvbl9lcnJvclwiLFxuICAgICAgICAgICAgICAgIHN0YXR1c0NvZGU6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkludGVybmFsIHNlcnZlciBlcnJvci4gV2UgYXJlIHVuYWJsZSB0byBwcm9jZXNzIHlvdXIgcmVxdWVzdCByaWdodCBub3csIHBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuXCJcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaGVhZGVyczogT2JqZWN0LmZyb21FbnRyaWVzKHJlc3BvbnNlLmhlYWRlcnMuZW50cmllcygpKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgZXJyb3IgPSB7XG4gICAgICAgICAgICBtZXNzYWdlOiByZXNwb25zZS5zdGF0dXNUZXh0LFxuICAgICAgICAgICAgc3RhdHVzQ29kZTogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICAgICAgbmFtZTogXCJhcHBsaWNhdGlvbl9lcnJvclwiXG4gICAgICAgICAgfTtcbiAgICAgICAgICBpZiAoZXJyIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgICAgIGVycm9yOiBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBlcnJvciksIHsgbWVzc2FnZTogZXJyLm1lc3NhZ2UgfSksXG4gICAgICAgICAgICAgIGhlYWRlcnM6IE9iamVjdC5mcm9tRW50cmllcyhyZXNwb25zZS5oZWFkZXJzLmVudHJpZXMoKSlcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICAgICAgZXJyb3IsXG4gICAgICAgICAgICBoZWFkZXJzOiBPYmplY3QuZnJvbUVudHJpZXMocmVzcG9uc2UuaGVhZGVycy5lbnRyaWVzKCkpXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRhdGEsXG4gICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICBoZWFkZXJzOiBPYmplY3QuZnJvbUVudHJpZXMocmVzcG9uc2UuaGVhZGVycy5lbnRyaWVzKCkpXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgbmFtZTogXCJhcHBsaWNhdGlvbl9lcnJvclwiLFxuICAgICAgICAgIHN0YXR1c0NvZGU6IG51bGwsXG4gICAgICAgICAgbWVzc2FnZTogXCJVbmFibGUgdG8gZmV0Y2ggZGF0YS4gVGhlIHJlcXVlc3QgY291bGQgbm90IGJlIHJlc29sdmVkLlwiXG4gICAgICAgIH0sXG4gICAgICAgIGhlYWRlcnM6IG51bGxcbiAgICAgIH07XG4gICAgfVxuICB9XG4gIGFzeW5jIHBvc3QocGF0aCwgZW50aXR5LCBvcHRpb25zID0ge30pIHtcbiAgICBjb25zdCBoZWFkZXJzID0gbmV3IEhlYWRlcnModGhpcy5oZWFkZXJzKTtcbiAgICBpZiAob3B0aW9ucy5oZWFkZXJzKSB7XG4gICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBuZXcgSGVhZGVycyhvcHRpb25zLmhlYWRlcnMpLmVudHJpZXMoKSkge1xuICAgICAgICBoZWFkZXJzLnNldChrZXksIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKG9wdGlvbnMuaWRlbXBvdGVuY3lLZXkpIHtcbiAgICAgIGhlYWRlcnMuc2V0KFwiSWRlbXBvdGVuY3ktS2V5XCIsIG9wdGlvbnMuaWRlbXBvdGVuY3lLZXkpO1xuICAgIH1cbiAgICBjb25zdCByZXF1ZXN0T3B0aW9ucyA9IF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGVudGl0eSlcbiAgICB9LCBvcHRpb25zKSwge1xuICAgICAgaGVhZGVyc1xuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLmZldGNoUmVxdWVzdChwYXRoLCByZXF1ZXN0T3B0aW9ucyk7XG4gIH1cbiAgYXN5bmMgZ2V0KHBhdGgsIG9wdGlvbnMgPSB7fSkge1xuICAgIGNvbnN0IGhlYWRlcnMgPSBuZXcgSGVhZGVycyh0aGlzLmhlYWRlcnMpO1xuICAgIGlmIChvcHRpb25zLmhlYWRlcnMpIHtcbiAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIG5ldyBIZWFkZXJzKG9wdGlvbnMuaGVhZGVycykuZW50cmllcygpKSB7XG4gICAgICAgIGhlYWRlcnMuc2V0KGtleSwgdmFsdWUpO1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCByZXF1ZXN0T3B0aW9ucyA9IF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe1xuICAgICAgbWV0aG9kOiBcIkdFVFwiXG4gICAgfSwgb3B0aW9ucyksIHtcbiAgICAgIGhlYWRlcnNcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5mZXRjaFJlcXVlc3QocGF0aCwgcmVxdWVzdE9wdGlvbnMpO1xuICB9XG4gIGFzeW5jIHB1dChwYXRoLCBlbnRpdHksIG9wdGlvbnMgPSB7fSkge1xuICAgIGNvbnN0IGhlYWRlcnMgPSBuZXcgSGVhZGVycyh0aGlzLmhlYWRlcnMpO1xuICAgIGlmIChvcHRpb25zLmhlYWRlcnMpIHtcbiAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIG5ldyBIZWFkZXJzKG9wdGlvbnMuaGVhZGVycykuZW50cmllcygpKSB7XG4gICAgICAgIGhlYWRlcnMuc2V0KGtleSwgdmFsdWUpO1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCByZXF1ZXN0T3B0aW9ucyA9IF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZW50aXR5KVxuICAgIH0sIG9wdGlvbnMpLCB7XG4gICAgICBoZWFkZXJzXG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMuZmV0Y2hSZXF1ZXN0KHBhdGgsIHJlcXVlc3RPcHRpb25zKTtcbiAgfVxuICBhc3luYyBwYXRjaChwYXRoLCBlbnRpdHksIG9wdGlvbnMgPSB7fSkge1xuICAgIGNvbnN0IGhlYWRlcnMgPSBuZXcgSGVhZGVycyh0aGlzLmhlYWRlcnMpO1xuICAgIGlmIChvcHRpb25zLmhlYWRlcnMpIHtcbiAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIG5ldyBIZWFkZXJzKG9wdGlvbnMuaGVhZGVycykuZW50cmllcygpKSB7XG4gICAgICAgIGhlYWRlcnMuc2V0KGtleSwgdmFsdWUpO1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCByZXF1ZXN0T3B0aW9ucyA9IF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShlbnRpdHkpXG4gICAgfSwgb3B0aW9ucyksIHtcbiAgICAgIGhlYWRlcnNcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5mZXRjaFJlcXVlc3QocGF0aCwgcmVxdWVzdE9wdGlvbnMpO1xuICB9XG4gIGFzeW5jIGRlbGV0ZShwYXRoLCBxdWVyeSkge1xuICAgIGNvbnN0IHJlcXVlc3RPcHRpb25zID0ge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocXVlcnkpLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzXG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5mZXRjaFJlcXVlc3QocGF0aCwgcmVxdWVzdE9wdGlvbnMpO1xuICB9XG59O1xuZXhwb3J0IHtcbiAgUmVzZW5kXG59O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/.pnpm/resend@6.4.1_@react-email+render@1.4.0_react-dom@19.2.0_react@19.2.0__react@19.2.0_/node_modules/resend/dist/index.mjs\n");

/***/ })

};
;